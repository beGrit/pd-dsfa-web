{"version":3,"sources":["webpack://platform/./designer/seat/util/eventBus.js","webpack://platform/./designer/seat/constant.js","webpack://platform/./designer/seat/func.js","webpack://platform/./node_modules/core-js/modules/es.object.get-own-property-names.js","webpack://platform/./node_modules/core-js/internals/object-get-own-property-names-external.js","webpack://platform/./designer/seat/util/configBuilder.js","webpack://platform/./designer/seat/seatDesign/widthInput.vue?75ff","webpack://platform/designer/seat/seatDesign/widthInput.vue","webpack://platform/./designer/seat/seatDesign/widthInput.vue?ed8f","webpack://platform/./designer/seat/seatDesign/widthInput.vue","webpack://platform/./designer/seat/seatView.vue?f2bd","webpack://platform/./designer/seat/seatView.vue?2508","webpack://platform/./designer/seat/seatView.vue?673b","webpack://platform/./designer/seat/seatView.vue?99f3","webpack://platform/./designer/seat/seatView/topTools.vue?60d1","webpack://platform/designer/seat/seatView/topTools.vue","webpack://platform/./designer/seat/seatView/topTools.vue?56b1","webpack://platform/./designer/seat/seatView/topTools.vue","webpack://platform/./designer/seat/seatView/leftTree.vue?19ff","webpack://platform/designer/seat/seatView/leftTree.vue","webpack://platform/./designer/seat/seatView/leftTree.vue?3d74","webpack://platform/./designer/seat/seatView/leftTree.vue","webpack://platform/./designer/seat/seatView/canvas.vue?bbe9","webpack://platform/designer/seat/seatView/canvas.vue","webpack://platform/./designer/seat/seatView/canvas.vue?68ee","webpack://platform/./designer/seat/seatView/canvas.vue","webpack://platform/./designer/seat/seatView/seatItem.vue?9f2e","webpack://platform/designer/seat/seatView/seatItem.vue","webpack://platform/./designer/seat/seatView/seatItem.vue?8680","webpack://platform/./designer/seat/seatView/seatItem.vue","webpack://platform/./designer/seat/seatView/seatPop.vue?7d91","webpack://platform/designer/seat/seatView/seatPop.vue","webpack://platform/./designer/seat/seatView/seatPop.vue?694d","webpack://platform/./designer/seat/seatView/seatPop.vue","webpack://platform/designer/seat/seatView.vue","webpack://platform/./designer/seat/seatView.vue?a3c0","webpack://platform/./designer/seat/seatView.vue"],"names":["EventBus","this","events","event","callback","undefined","arr","_","isArray","push","params","eventDeal","forEach","a","Object","entries","eventBus","window","$simpleEventBus","uploadUrl","eventBusEvent","uploadImg","formData","self","config","headers","transformRequest","data","loadingIndex","dsf","layer","loading","$http","post","done","res","isDef","success","message","error","err","always","closeLoading","updateGroupMemberPosition","group","member","totalTop","height","rows","totalLeft","width","cols","eachTop","eachLeft","item","rowIndex","top","floor","colIndex","left","getMemberSpaceLeft","getMemberSpaceTop","forzenOtherItems","isForzenMemberSty","items","el","isFrozenSty","selectedItems","select","id","groups","length","isFrozenMemberSty","unForzenAllItems","createUploadFileInput","inputName","$","remove","upDOM","document","createElement","type","accept","style","display","name","body","appendChild","changePanelSizeForBgImage","isEmpty","postData","backgroundImage","bg_w","bg_h","box_w","canvasSet","scale","css","absolutePath","sysBindShortKey","keyStack","stopList","keyCode","keyNum2Str","on","evt","index","indexOf","keyStr","join","includes","stopPropagation","preventDefault","emit","KEY_CTRL_D","KEY_DELETE","pull","newRelative","seat","person","pid","parentId","belong","currentState","stateList","seatNum","fails","getOwnPropertyNames","f","FAILS_ON_PRIMITIVES","target","stat","forced","toIndexedObject","$getOwnPropertyNames","toString","windowNames","getWindowNames","it","slice","module","exports","call","ConfigBuilder","business","alert","key","msg","title","Error","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","inline","model","label","controls","precision","placeholder","value","$$v","$set","expression","disabled","hasBg","staticRenderFns","_withStripped","props","required","Boolean","watch","handler","$store","commit","val","deep","component","options","__file","content","i","locals","add","default","_b","relativeList","seatObj","relativeObj","$event","save","clear","personObj","scopedSlots","_u","fn","chosenItems","proxy","_l","layout","buttons","button","$index","icon","text","click","directives","rawName","inject","url","Array","components","widthInput","normalButtons","computed","layoutConfig","layoutConfigPointer","created","methods","$emit","restoreLayout","compelPanelSize","panelSize","autoSeat","rel","couldSeat","needPop","confirm","clearSeat","emptySeatUtilize","min","num","temp","$nextTick","k","havePersonArr","isFunction","isSeatAble","exportImage","download","href","dataUrl","removeChild","loader","_v","_s","clickSort","ref","list","leafProps","lazy","load","lazyLoad","openMultipleChoose","filterNode","personIdAlias","nodeExpand","node","class","draggable","isLeaf","$refs","leftTree","setCheckedNodes","filter","childrenAlias","children","labelAlias","seatedPerson","obj","personId","assign","getLeafs","get","result","realUser","orderPerson","recurData","func","resolve","createInteraction","addClasses","start","helper","nodes","getCheckedNodes","getPersonNode","str","cursor","cursorAt","stop","revert","addPersonRevertListener","listenAutoSeat","excludePersonId","temp2","seated","recurse","childNodes","canvasCss","_k","canvasClick","apply","arguments","panelSty","_t","mounted","addEventListener","handleScroll","ctrlKey","x","pageX","y","pageY","wheelAction","newS","Math","round","sw","sh","l","t","myItems","realSeatCss","getItemSty","personNameAlias","contextmenu","popMenu","mulChooseSeat","domProps","textContent","charAt","seatTxt","myGroups","g","hideText","showText","m","getMemberSty","visible","slot","seatCover","seatInsert","seatCancel","haveReaded","leftTreeConfig","removeClass","currentVal","jud","ischosenRreference","anchor","each","addClass","append","beforeDestroy","off","chosenIndex","splice","lastObj","some","currentIndex","lastObjIndex","cleanArr","transform","sty","background","getBgSty","test","which","targetDOM","setRect2Active","position","currentItem","droppable","tolerance","over","seatDOM","hasClass","drop","ui","attr","dropSeatObj","groupContainer","find","persons","mPersonIds","multiple2seated","out","mPersonid","popConfirm","getDOM","isSeatBox","parents","eq","sort","simpleInsertSeat","activeId","getAbsolutePath","bgImg","img","judge","popShow","isExistPerson","removePerson","_e","splicePerson","seat2work","otherList","clickOther","statusText","dialogVisible","modal","state","all","statusValue","leftTreeConfigPointer","seatState","popDialog","_singleSetStatus","startSeatNum","targetItem","provide","_id","leftList","topTools","seatCanvas","canvas","seatItem","seatPop","importFiles","layoutUrl","leftTreeUrl","then","getSeatInfo","b","relId","bindShortKey","localStorage","setItem","JSON","stringify","$router","replace"],"mappings":"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","file":"modules/platform/js/dsf-platform.seatView.js","sourcesContent":["class EventBus {\r\n  constructor() {\r\n    this.events = {};\r\n  }\r\n  \r\n  listen(event, callback){\r\n    if (this.events[event] === undefined){\r\n      this.events[event] = [callback];\r\n    }\r\n    else {\r\n      const arr = this.events[event];\r\n      if (!_.isArray(arr)){\r\n        console.log(`请使用 on 来监听 ${event} 事件`)\r\n        return\r\n      }\r\n      arr.push(callback)\r\n    }\r\n  }\r\n  dispatch(event, params){\r\n    const eventDeal = this.events[event];\r\n    if (!eventDeal){\r\n      console.log(event + \"未使用listen 注册\")\r\n      return;\r\n    }\r\n    \r\n    if (!_.isArray(eventDeal)){\r\n      console.log(event + \"被on注册, 应使用emit触发\")\r\n      return\r\n    }\r\n    eventDeal.forEach(a => {\r\n      a(params)\r\n    })\r\n  }\r\n\r\n  on(event, callback)  {\r\n    if (this.events[event] === undefined){\r\n      this.events[event] = callback\r\n    }\r\n    else if (_.isArray(this.events[event])){\r\n      console.log(`请使用 listen 来监听 ${event} 事件`);\r\n    }\r\n    else {\r\n      console.log(event + \" 监听器重名\");\r\n    }\r\n  }\r\n  emit(event, params) {\r\n    const eventDeal = this.events[event]\r\n    if (!eventDeal){\r\n      console.log(event + \"未使用on 注册\")\r\n      return;\r\n    }\r\n    if (_.isArray(eventDeal)){\r\n      console.log(event + \"被listen注册, 应使用dispatch触发\")\r\n      return\r\n    }\r\n  \r\n    eventDeal(params)\r\n  }\r\n  off(event) {\r\n    this.events[event] = undefined;\r\n  }\r\n  clear(){\r\n    this.events = {}\r\n  }\r\n\r\n  $getAllListener(){\r\n    return Object.entries(this.events)\r\n  }\r\n}\r\n\r\nconst eventBus = new EventBus();\r\nwindow.$simpleEventBus = eventBus;\r\nexport default eventBus","const uploadUrl = \"file/upload/\";\r\nconst eventBusEvent = {\r\n  //配置文件加载完成\r\n  \"CONFIG_FILE_LOADED\": \"config_file_loaded\",\r\n  \r\n  //seatDesign 有关的事件\r\n  \"KEY_DELETE\": \"key_delete\",\r\n  \"KEY_CTRL_D\":\"key_ctrl_d\",\r\n  \"BODY_EMPTY_CLICK\": \"body_empty_click\",\r\n  \"SEAT_POP\": \"seat_pop\",\r\n  \"GET_ACTIVE_SEAT\": \"get_active_seat\",\r\n  \"CLEAN_ALL_SEAT_NUM\": \"clean_all_seat_num\",\r\n  \"CLEAN_SELECT_SEAT_NUM\": \"clean_select_seat_num\",\r\n  \"AFTER_QUICK_ORDER\": \"after_quick_order\",\r\n  \r\n  //seatView 有关的事件\r\n  \"PERSON_REVERT_TREE\": \"person_revert_tree\",\r\n  \"LEFT_CLICK_SEAT\": \"left_click_seat\",\r\n  \"AUTO_SEAT\": \"auto_seat\",\r\n  \r\n  //printingDesign 有关的事件\r\n  \"LEVEL_UP\": \"level_up\",\r\n  \"LEVEL_DOWN\": \"level_down\"\r\n}\r\nexport {\r\n  uploadUrl,\r\n  eventBusEvent\r\n}","import {eventBusEvent, uploadUrl} from './constant'\r\nimport eventBus from \"_platform/designer/seat/util/eventBus\";\r\n\r\n/*seatDesign 里面使用的方法*/\r\nexport function uploadImg(formData, callback) {\r\n  const self = this;\r\n  const config = {\r\n    headers: {'Content-Type': 'multipart/form-data'},\r\n    transformRequest: [function (data, headers) {\r\n      return data;\r\n    }],\r\n  };\r\n  \r\n  let loadingIndex = dsf.layer.loading();\r\n  self.$http.post(uploadUrl, formData, config)\r\n    .done(res => {\r\n      if (!dsf.isDef(res.data) || !res.success) {\r\n        dsf.layer.message(res.message, false);\r\n        callback && callback(\"error\")\r\n        return false\r\n      }\r\n      \r\n      callback && callback(res.data);\r\n    })\r\n    .error(err => {\r\n      dsf.layer.message(\"上传图片失败\", false);\r\n      callback && callback(\"error\");\r\n    })\r\n    .always(() => {\r\n      dsf.layer.closeLoading(loadingIndex);\r\n    })\r\n}\r\n\r\nexport function updateGroupMemberPosition(group) {\r\n  const member = group.member[0];\r\n  let totalTop = group.height - member.height * group.rows;\r\n  let totalLeft = group.width - member.width * group.cols;\r\n  let eachTop = group.rows > 1 ? totalTop / (group.rows - 1) : 0;\r\n  let eachLeft = group.cols > 1 ? totalLeft / (group.cols - 1) : 0;\r\n  group.member.forEach(item => {\r\n    if (item.rowIndex > 0) item.top = _.floor((item.height + eachTop) * item.rowIndex, 2);\r\n    if (item.colIndex > 0) item.left = _.floor((item.width + eachLeft) * item.colIndex, 2);\r\n  })\r\n}\r\n\r\nexport function getMemberSpaceLeft(group) {\r\n  const member = group.member[0];\r\n  let totalLeft = group.width - member.width * group.cols;\r\n  return group.cols === 1 ? 0 : _.floor(totalLeft / (group.cols - 1), 2)\r\n}\r\n\r\nexport function getMemberSpaceTop(group) {\r\n  const member = group.member[0];\r\n  let totalTop = group.height - member.height * group.rows;\r\n  return group.rows === 1 ? 0 : _.floor(totalTop / (group.rows - 1), 2)\r\n}\r\n\r\n//冻结其他对象(未被激活对象)的样式渲染\r\nexport function forzenOtherItems(isForzenMemberSty = true) {\r\n  this.items.forEach(el => {\r\n    el.isFrozenSty = true;\r\n    this.selectedItems.forEach(select => {\r\n      if (el.id === select.id) {\r\n        el.isFrozenSty = false\r\n      }\r\n    })\r\n  })\r\n  if (this?.groups?.length > 0) {\r\n    this.groups.forEach(el => {\r\n      el.isFrozenSty = true;\r\n      el.isFrozenMemberSty = true;\r\n      this.selectedItems.forEach(select => {\r\n        if (el.id === select.id) {\r\n          el.isFrozenSty = false\r\n          !isForzenMemberSty && (el.isFrozenMemberSty = false)\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\n//解冻所有对象,重新渲染\r\nexport function unForzenAllItems() {\r\n  this.items.forEach(el => {\r\n    el.isFrozenSty = false\r\n  })\r\n  this.groups.forEach(el => {\r\n    el.isFrozenSty = false;\r\n    el.isFrozenMemberSty = false;\r\n  })\r\n}\r\n\r\nexport function createUploadFileInput(inputName = \"dsf-seat-upload\") {\r\n  $(`input[name='${inputName}']`).remove();\r\n  let upDOM = document.createElement(\"input\");\r\n  upDOM.type = \"file\";\r\n  upDOM.accept = \"image/*\";\r\n  upDOM.style.display = \"none\"\r\n  upDOM.name = inputName;\r\n  document.body.appendChild(upDOM);\r\n  return upDOM\r\n}\r\n\r\nexport function changePanelSizeForBgImage() {\r\n  const self = this;\r\n  if (_.isEmpty(self.postData.backgroundImage)) return; //如果没有背景则返回\r\n  let bg_w = self.postData.backgroundImage.width;\r\n  let bg_h = self.postData.backgroundImage.height;\r\n  let box_w = self.postData.canvasSet.width || $(\".seat-designer-page\").width();   //若画布宽没有设置值\r\n  let scale = box_w / bg_w;\r\n  \r\n  self.postData.canvasSet.width = box_w;\r\n  self.postData.canvasSet.height = bg_h * scale;\r\n  $(\"#panel_bg\").css(\"background-image\", \"url(\" + self.postData.backgroundImage.absolutePath + \")\");\r\n}\r\n\r\nexport function sysBindShortKey(keyStack, stopList) {\r\n  let keyCode;\r\n  const keyNum2Str = (keyCode) => {\r\n    switch (keyCode) {\r\n    case 17:\r\n      keyCode = \"ctrl\";\r\n      break;\r\n    case 68:\r\n      keyCode = \"d\";\r\n      break;\r\n    case 65:\r\n      keyCode = \"a\";\r\n      break;\r\n    case 46:\r\n      keyCode = \"delete\";\r\n      break;\r\n    case 16:\r\n      keyCode = \"shift\";\r\n      break;\r\n    case 83:\r\n      keyCode = \"s\";\r\n      break;\r\n    default:\r\n      keyCode = null;\r\n    }\r\n    return keyCode\r\n  }\r\n  \r\n  $(\"body\").on(\"keydown\", function (evt) {\r\n    keyCode = keyNum2Str(evt.keyCode);\r\n    if (!keyCode) return;\r\n    let index = keyStack.indexOf(keyCode);\r\n    if (index === -1) keyStack.push(keyCode);\r\n    let keyStr = keyStack.join(\"-\");\r\n    if (stopList.includes(keyStr)) {\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n    }\r\n    \r\n    if (keyStr === \"ctrl-d\") {\r\n      eventBus.emit(eventBusEvent.KEY_CTRL_D);\r\n    }\r\n    if (keyStr === \"delete\") {\r\n      eventBus.emit(eventBusEvent.KEY_DELETE)\r\n    }\r\n  });\r\n  $(\"body\").on(\"keyup\", function (evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    keyCode = keyNum2Str(evt.keyCode);\r\n    _.pull(keyStack, keyCode);   //删除对应的keyCode\r\n  });\r\n}\r\n\r\n\r\n/*seatView 里面使用的方法*/\r\n//创建一条新的人员入座记录\r\nexport function newRelative(seat, person) {\r\n  return {\r\n    id: seat.id,\r\n    pid: seat.parentId,\r\n    belong: seat.belong,\r\n    currentState: seat.stateList[1],\r\n    person: person,\r\n    seatNum: seat.seatNum\r\n  }\r\n}","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names-external').f;\n\n// eslint-disable-next-line es/no-object-getownpropertynames -- required for testing\nvar FAILS_ON_PRIMITIVES = fails(function () { return !Object.getOwnPropertyNames(1); });\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  getOwnPropertyNames: getOwnPropertyNames\n});\n","/* eslint-disable es/no-object-getownpropertynames -- safe */\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\n\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return $getOwnPropertyNames(it);\n  } catch (error) {\n    return windowNames.slice();\n  }\n};\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]'\n    ? getWindowNames(it)\n    : $getOwnPropertyNames(toIndexedObject(it));\n};\n","export default class ConfigBuilder {\r\n  constructor(config, business) {\r\n    this.config = config;\r\n    if (!business){\r\n      this.alert(\"url里面缺少必要的opt参数\");\r\n    }\r\n    if (!this.config[business]) {\r\n      this.alert(`[${this.config.name}] url里面的opt参数没有对应的配置项`);\r\n    }\r\n    Object.getOwnPropertyNames(this.config[business]).forEach(key => {\r\n      this[key] = this.config[business][key];\r\n    })\r\n  }\r\n  \r\n  alert(msg){\r\n    dsf.layer.alert({\r\n      title: \"警告\",\r\n      type: \"warning\",\r\n      message: msg\r\n    });\r\n    throw new Error(msg)\r\n  }\r\n}","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"input-box\" },\n    [\n      _c(\n        \"el-form\",\n        {\n          staticClass: \"demo-form-inline\",\n          attrs: { inline: true, model: _vm.canvasSet, \"label-width\": \"100px\" }\n        },\n        [\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"画布宽\" } },\n            [\n              _c(\"el-input-number\", {\n                attrs: { controls: false, precision: 0, placeholder: \"自适应\" },\n                model: {\n                  value: _vm.canvasSet.width,\n                  callback: function($$v) {\n                    _vm.$set(_vm.canvasSet, \"width\", $$v)\n                  },\n                  expression: \"canvasSet.width\"\n                }\n              })\n            ],\n            1\n          ),\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"画布高\" } },\n            [\n              _c(\"el-input-number\", {\n                attrs: {\n                  controls: false,\n                  disabled: _vm.hasBg,\n                  precision: 0,\n                  placeholder: \"自适应\"\n                },\n                model: {\n                  value: _vm.canvasSet.height,\n                  callback: function($$v) {\n                    _vm.$set(_vm.canvasSet, \"height\", $$v)\n                  },\n                  expression: \"canvasSet.height\"\n                }\n              })\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"input-box\">\r\n    <el-form :inline=\"true\" :model=\"canvasSet\" label-width=\"100px\" class=\"demo-form-inline\">\r\n      <el-form-item label=\"画布宽\">\r\n        <el-input-number v-model=\"canvasSet.width\" :controls=\"false\" :precision=\"0\" placeholder=\"自适应\"></el-input-number>\r\n      </el-form-item>\r\n      \r\n      <el-form-item label=\"画布高\">\r\n        <el-input-number v-model=\"canvasSet.height\" :controls=\"false\" :disabled=\"hasBg\" :precision=\"0\" placeholder=\"自适应\"></el-input-number>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"WidthInput\",\r\n  props:{\r\n    canvasSet: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    hasBg:{\r\n      type: Boolean\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n\r\n    }\r\n  },\r\n  watch: {\r\n    canvasSet: {\r\n      handler(val) {\r\n        const self = this;\r\n        const {width, height} = val;\r\n        const lef = $(\".seat-designer-page\").offset().left;\r\n        const top = $(\".seat-designer-page\").offset().top;\r\n        const screenHit = $(window).height();\r\n        const screenWid = $(window).width();\r\n        if (width && (width + lef > screenWid)) {\r\n          $(\".seat-designer-center\").css({\"overflow-x\": \"scroll\"});\r\n        } else {\r\n          $(\".seat-designer-center\").css({\"overflow-x\": \"auto\"});\r\n        }\r\n        if (height && (height + top > screenHit)) {\r\n          $(\".seat-designer-center\").css(\"overflow-y\", \"scroll\");\r\n        } else {\r\n          $(\".seat-designer-center\").css(\"overflow-y\", \"auto\");\r\n        }\r\n        self.$store.commit(\"seatDesign/changeCompelPanelSize\", val);\r\n      },\r\n      deep: true\r\n    },\r\n  },\r\n}\r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./widthInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./widthInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./widthInput.vue?vue&type=template&id=4f3e190c&\"\nimport script from \"./widthInput.vue?vue&type=script&lang=js&\"\nexport * from \"./widthInput.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('4f3e190c')) {\n      api.createRecord('4f3e190c', component.options)\n    } else {\n      api.reload('4f3e190c', component.options)\n    }\n    module.hot.accept(\"./widthInput.vue?vue&type=template&id=4f3e190c&\", function () {\n      api.rerender('4f3e190c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatDesign/widthInput.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-1-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-oneOf-1-4!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=style&index=0&lang=scss&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"73500cba\", content, false, {\"sourceMap\":false,\"shadowMode\":false});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-1-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-oneOf-1-4!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=style&index=0&lang=scss&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-1-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-oneOf-1-4!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=style&index=0&lang=scss&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","export * from \"-!../../../../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-1-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-oneOf-1-4!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\nexport {};","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"ds-designer ds-seat-container ds-seat-view\" },\n    [\n      _c(\n        \"div\",\n        { staticClass: \"designer-head\" },\n        [\n          _c(\n            \"top-tools\",\n            _vm._b(\n              {\n                attrs: {\n                  \"relative-list\": _vm.relativeList,\n                  \"seat-obj\": _vm.seatObj,\n                  \"relative-obj\": _vm.relativeObj\n                },\n                on: {\n                  \"update:relativeList\": function($event) {\n                    _vm.relativeList = $event\n                  },\n                  \"update:relative-list\": function($event) {\n                    _vm.relativeList = $event\n                  },\n                  save: _vm.save,\n                  clear: _vm.clear\n                }\n              },\n              \"top-tools\",\n              _vm.postData,\n              false,\n              true\n            )\n          )\n        ],\n        1\n      ),\n      _c(\"div\", { staticClass: \"designer-content\" }, [\n        _c(\n          \"div\",\n          { staticClass: \"seat-designer-center\" },\n          [\n            _c(\"left-tree\", {\n              attrs: {\n                \"relative-list\": _vm.relativeList,\n                \"person-obj\": _vm.personObj,\n                \"seat-obj\": _vm.seatObj,\n                \"relative-obj\": _vm.relativeObj\n              },\n              on: {\n                \"update:relativeList\": function($event) {\n                  _vm.relativeList = $event\n                },\n                \"update:relative-list\": function($event) {\n                  _vm.relativeList = $event\n                },\n                \"update:personObj\": function($event) {\n                  _vm.personObj = $event\n                },\n                \"update:person-obj\": function($event) {\n                  _vm.personObj = $event\n                }\n              }\n            }),\n            _c(\"seat-canvas\", {\n              scopedSlots: _vm._u([\n                {\n                  key: \"seat\",\n                  fn: function() {\n                    return [\n                      _c(\n                        \"seat-item\",\n                        _vm._b(\n                          {\n                            attrs: {\n                              \"relative-list\": _vm.relativeList,\n                              \"chosen-items\": _vm.chosenItems,\n                              \"key-stack\": _vm.keyStack,\n                              \"seat-obj\": _vm.seatObj,\n                              \"person-obj\": _vm.personObj,\n                              \"relative-obj\": _vm.relativeObj\n                            },\n                            on: {\n                              \"update:relativeList\": function($event) {\n                                _vm.relativeList = $event\n                              },\n                              \"update:relative-list\": function($event) {\n                                _vm.relativeList = $event\n                              },\n                              \"update:chosenItems\": function($event) {\n                                _vm.chosenItems = $event\n                              },\n                              \"update:chosen-items\": function($event) {\n                                _vm.chosenItems = $event\n                              }\n                            }\n                          },\n                          \"seat-item\",\n                          _vm.postData,\n                          false,\n                          true\n                        )\n                      )\n                    ]\n                  },\n                  proxy: true\n                },\n                {\n                  key: \"seatPop\",\n                  fn: function() {\n                    return [\n                      _c(\"seat-pop\", {\n                        attrs: {\n                          \"relative-list\": _vm.relativeList,\n                          \"chosen-items\": _vm.chosenItems,\n                          \"seat-obj\": _vm.seatObj,\n                          \"relative-obj\": _vm.relativeObj\n                        },\n                        on: {\n                          \"update:relativeList\": function($event) {\n                            _vm.relativeList = $event\n                          },\n                          \"update:relative-list\": function($event) {\n                            _vm.relativeList = $event\n                          },\n                          \"update:chosenItems\": function($event) {\n                            _vm.chosenItems = $event\n                          },\n                          \"update:chosen-items\": function($event) {\n                            _vm.chosenItems = $event\n                          }\n                        }\n                      })\n                    ]\n                  },\n                  proxy: true\n                }\n              ])\n            })\n          ],\n          1\n        )\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"designer_tools\" },\n    [\n      _vm._l(_vm.layout.buttons, function(button, $index) {\n        return _c(\"DsfButton\", {\n          key: $index,\n          attrs: {\n            icon: button.icon,\n            text: button.text,\n            \"btn-style\": \"icon-text\"\n          },\n          on: {\n            click: function($event) {\n              return button.handler($event, button)\n            }\n          }\n        })\n      }),\n      _c(\"width-input\", {\n        directives: [\n          { name: \"show\", rawName: \"v-show\", value: false, expression: \"false\" }\n        ],\n        attrs: { \"canvas-set\": _vm.canvasSet, \"has-bg\": _vm.hasBg }\n      })\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"designer_tools\">\r\n    <DsfButton\r\n      v-for=\"(button, $index) in layout.buttons\"\r\n      :key=\"$index\"\r\n      :icon=\"button.icon\"\r\n      :text=\"button.text\"\r\n      btn-style=\"icon-text\"\r\n      class=\"\"\r\n      @click=\"button.handler($event, button)\"/>\r\n    <width-input v-show=\"false\" :canvas-set=\"canvasSet\" :has-bg=\"hasBg\"></width-input>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport html2canvas from 'html2canvas';\r\nimport {mapState} from 'vuex';\r\nimport widthInput from \"_platform/designer/seat/seatDesign/widthInput\";\r\nimport eventBus from \"_platform/designer/seat/util/eventBus\";\r\nimport {eventBusEvent} from \"_platform/designer/seat/constant\";\r\nimport {newRelative} from \"_platform/designer/seat/func\";\r\n  \r\nexport default {\r\n  name: \"TopTools\",\r\n  inject: ['layoutConfigPointer'],\r\n  props: {\r\n    backgroundImage: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          url: \"\",\r\n          width: 0,\r\n          height: 0,\r\n        }\r\n      }\r\n    },\r\n    canvasSet: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          width: undefined,\r\n          height: undefined,\r\n        }\r\n      }\r\n    },\r\n    hasBg: {\r\n      type: Boolean,\r\n      default: false\r\n    },   //是否有底图\r\n    //所有排座情况\r\n    relativeList: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n      \r\n    seatObj: {\r\n      type: Object,\r\n      default() {\r\n        return null\r\n      }\r\n    },\r\n    relativeObj: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    widthInput\r\n  },\r\n  data() {\r\n    return {\r\n      //普通情况下的按钮\r\n      normalButtons: [\r\n        {text: \"保存\", icon: \"baocun\", handler: this.save},\r\n        {text: \"自动排座\", icon: \"zidongpipei\", handler: this.autoSeat},\r\n        {text: \"清空排座\", icon: \"guanbi2\", handler: this.clearSeat},\r\n        {text: \"自动补位\", icon: \"zhiding2\", handler: this.emptySeatUtilize},\r\n        {text: \"底图复位\", icon: \"shuaxin\", handler: this.restoreLayout},\r\n        {text: \"导出\", icon: \"yunduanxiazai\", handler: this.exportImage},\r\n      ],\r\n      layout: {\r\n        buttons: [],\r\n      },\r\n    }\r\n  },\r\n    \r\n  computed: {\r\n    ...mapState('seatDesign', [\r\n      \"compelPanelSize\",\r\n    ]),\r\n    layoutConfig(){\r\n      return this.layoutConfigPointer()\r\n    }\r\n  },\r\n  watch: {},\r\n  created() {\r\n    this.layout.buttons = this.normalButtons;\r\n  },\r\n  methods: {\r\n    save() {\r\n      this.$emit(\"save\");\r\n    },\r\n    restoreLayout() {\r\n      const panelSize = {\r\n        width: this.compelPanelSize.width,\r\n        height: this.compelPanelSize.height,\r\n        scale: 1,\r\n        left: 0,\r\n        top: 0,\r\n      }\r\n      this.$store.commit(\"seatDesign/changePanelSize\", panelSize);\r\n    },\r\n    autoSeat() {\r\n      let needPop = false;\r\n      for (let i = 0; i < this.relativeList.length; i++) {\r\n        let rel = this.relativeList[i];\r\n        //有人，且该座位未被锁定\r\n        if (rel.person && rel.currentState.couldSeat !== 2) {\r\n          needPop = true\r\n          break;\r\n        }\r\n      }\r\n        \r\n      if (needPop) {\r\n        dsf.layer.confirm({\r\n          title: '提醒',\r\n          message: \"该操作会清除当前所有已排人员重新排位，是否要继续?\"\r\n        }).then(() => {\r\n          eventBus.emit(eventBusEvent.AUTO_SEAT)\r\n        }).catch(() => {\r\n          \r\n        });\r\n      } else {\r\n        eventBus.emit(eventBusEvent.AUTO_SEAT)\r\n      }\r\n    },\r\n    clearSeat() {\r\n      dsf.layer.confirm({\r\n        title: '提醒',\r\n        message: \"该操作将清除当前所有排座的信息,是否要继续?\"\r\n      }).then(() => {\r\n        this.$emit(\"clear\");\r\n      }).catch(() => {\r\n          \r\n      });\r\n        \r\n    },\r\n    emptySeatUtilize() {\r\n      let min;\r\n      for (let i = 0; i < this.relativeList.length; i++) {\r\n        let rel = this.relativeList[i];\r\n        if (!rel.person) continue;\r\n        min = rel.seatNum < min || !min ? rel.seatNum : min\r\n      }\r\n        \r\n      const arr = [];\r\n      const havePersonArr = [];\r\n      for (let num in this.relativeObj) {\r\n        let rel = this.relativeObj[num];\r\n        if (num < min || rel.currentState.couldSeat === 2) continue;\r\n        arr.push(rel);\r\n        if (rel.person) havePersonArr.push(rel)\r\n      }\r\n        \r\n      //先删除这些座位\r\n      const temp = this.relativeList.filter(a => {\r\n        let index = arr.findIndex(b => b.id === a.id)\r\n        return index === -1\r\n      })\r\n      this.$emit(\"update:relativeList\", temp);\r\n        \r\n      //再重新将人按顺序插入\r\n      this.$nextTick(() => {\r\n        let i = 0, k = 0\r\n        while (k < havePersonArr.length) {\r\n          const seat = this.seatObj[min + i];\r\n          const person = havePersonArr[k].person;\r\n          if (this.relativeObj[min + i]?.currentState?.couldSeat === 2) {\r\n            i++\r\n            continue\r\n          }\r\n          if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n            let isSeatAble = this.layoutConfig.isSeatAble(seat, person)\r\n            if (!isSeatAble) {\r\n              i++\r\n              continue;\r\n            }\r\n          }\r\n          this.relativeList.push(newRelative(seat, person))\r\n          i++;\r\n          k++;\r\n        }\r\n      })\r\n        \r\n        \r\n    },\r\n    exportImage() {\r\n      const loader = dsf.layer.loading();\r\n      const panelEl = document.getElementById(\"panel_outer\")\r\n      html2canvas(panelEl).then(function(canvas) {\r\n        const dataUrl = canvas.toDataURL(\"image/png\")\r\n        const a = document.createElement(\"a\");\r\n        a.style.display = \"none\"\r\n        a.download = \"排座.png\"\r\n        a.href = dataUrl;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        dsf.layer.closeLoading(loader);\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./topTools.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./topTools.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./topTools.vue?vue&type=template&id=65c0fe27&\"\nimport script from \"./topTools.vue?vue&type=script&lang=js&\"\nexport * from \"./topTools.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('65c0fe27')) {\n      api.createRecord('65c0fe27', component.options)\n    } else {\n      api.reload('65c0fe27', component.options)\n    }\n    module.hot.accept(\"./topTools.vue?vue&type=template&id=65c0fe27&\", function () {\n      api.rerender('65c0fe27', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView/topTools.vue\"\nexport default component.exports","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"designer-left\" }, [\n    _c(\n      \"div\",\n      { staticClass: \"designer-left-tools\" },\n      [\n        _c(\n          \"div\",\n          { staticClass: \"title\" },\n          [\n            _c(\"span\", [_vm._v(_vm._s(_vm.title))]),\n            _c(\"dsf-icon\", {\n              attrs: { name: \"paixu\" },\n              on: { click: _vm.clickSort }\n            })\n          ],\n          1\n        ),\n        _c(\"el-tree\", {\n          ref: \"leftTree\",\n          attrs: {\n            data: _vm.list,\n            props: _vm.leafProps,\n            lazy: _vm.lazy,\n            load: _vm.lazyLoad,\n            \"default-expand-all\": false,\n            \"expand-on-click-node\": false,\n            \"check-on-click-node\": true,\n            \"show-checkbox\": _vm.openMultipleChoose,\n            \"filter-node-method\": _vm.filterNode,\n            \"node-key\": _vm.personIdAlias || \"_id\"\n          },\n          on: { \"node-expand\": _vm.nodeExpand },\n          scopedSlots: _vm._u([\n            {\n              key: \"default\",\n              fn: function(ref) {\n                var node = ref.node\n                var data = ref.data\n                return _c(\n                  \"div\",\n                  {\n                    staticClass: \"my-tree-node\",\n                    class: { draggable: data.draggable },\n                    attrs: { \"data-id\": data[_vm.leafProps.id] }\n                  },\n                  [_vm._v(\" \" + _vm._s(data[_vm.leafProps.label]) + \" \")]\n                )\n              }\n            }\n          ])\n        })\n      ],\n      1\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"designer-left\">\r\n    <div class=\"designer-left-tools\">\r\n      <div class=\"title\">\r\n        <span>{{ title }}</span>\r\n        <dsf-icon @click=\"clickSort\" name=\"paixu\"></dsf-icon>\r\n      </div>\r\n      <el-tree\r\n        ref=\"leftTree\"\r\n        :data=\"list\"\r\n        :props=\"leafProps\"\r\n        :lazy=\"lazy\"\r\n        :load=\"lazyLoad\"\r\n        :default-expand-all=\"false\"\r\n        :expand-on-click-node=\"false\"\r\n        :check-on-click-node=\"true\"\r\n        :show-checkbox=\"openMultipleChoose\"\r\n        @node-expand=\"nodeExpand\"\r\n        :filter-node-method=\"filterNode\"\r\n        :node-key=\"personIdAlias || '_id'\"\r\n      >\r\n        <div class=\"my-tree-node\" slot-scope=\"{node, data}\" :class=\"{'draggable': data.draggable}\" :data-id=\"data[leafProps.id]\">\r\n          {{ data[leafProps.label] }}\r\n        </div>\r\n      </el-tree>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\";\r\nimport eventBus from \"_platform/designer/seat/util/eventBus\";\r\nimport {eventBusEvent} from \"_platform/designer/seat/constant\";\r\nimport {newRelative} from \"_platform/designer/seat/func\";\r\n  \r\nexport default {\r\n  name: \"LeftTree\",\r\n  inject: ['layoutConfigPointer', 'leftTreeConfigPointer'],\r\n  props: {\r\n    personObj: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      }\r\n    },\r\n    relativeList:{\r\n      type: Array,\r\n      default(){\r\n        return []\r\n      }\r\n    },\r\n    seatObj: {\r\n      type: Object,\r\n      default() {\r\n        return null\r\n      }\r\n    },\r\n    relativeObj: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      title: \"\",\r\n      leafProps: {},\r\n      lazy: false,\r\n      isLeaf: \"isLeaf\",\r\n      openMultipleChoose: false, //默认不开启多选\r\n      list: [],\r\n    };\r\n  },\r\n  watch:{\r\n    relativeList:{\r\n      handler(){\r\n        this.$refs.leftTree.setCheckedNodes([]); //清空已选择的节点\r\n        this.$refs.leftTree.filter()\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(\"seatDesign\", [\"panelSize\", \"compelPanelSize\"]),\r\n    personIdAlias(){\r\n      return this.leafProps.id\r\n    },\r\n    childrenAlias(){\r\n      return this.leafProps.children\r\n    },\r\n    labelAlias(){\r\n      return this.leafProps.label\r\n    },\r\n    seatedPerson(){\r\n      const obj = {};\r\n      for (let i=0; i<this.relativeList.length; i++){\r\n        let a = this.relativeList[i];\r\n        if (!a.person) continue;\r\n        let personId = a['person'][this.personIdAlias]\r\n        obj[personId] = a.person\r\n      }\r\n      return obj\r\n    },\r\n  },\r\n  created() {\r\n    eventBus.listen(eventBusEvent.CONFIG_FILE_LOADED, ()=>{\r\n      this.leftTreeConfig = this.leftTreeConfigPointer();\r\n      this.layoutConfig = this.layoutConfigPointer()\r\n      Object.assign(this, this.leftTreeConfig); //将config填写进data\r\n  \r\n      this.getLeafs();\r\n      this.addPersonRevertListener();\r\n    })\r\n  },\r\n  methods: {\r\n    filterNode(val, data){\r\n      data['sys_seated'] = !!this.seatedPerson[data[this.personIdAlias]]  //加入已入座标识\r\n      return !this.seatedPerson[data[this.personIdAlias]]\r\n    },\r\n    clickSort() {},\r\n    getLeafs() {\r\n      let url = this.leftTreeConfig.getLeafsUrl;\r\n      this.$http.get(url).done((res) => {\r\n        let result;\r\n        if (_.isFunction(this.leftTreeConfig.dealRespond)) {\r\n          result = this.leftTreeConfig.dealRespond(res.data);\r\n        } else {\r\n          result = res.data;\r\n        }\r\n        \r\n        const personObj = {};\r\n        const orderPerson = [];\r\n        //递归函数\r\n        const recurData = list => {\r\n          for (let i=0; i<list.length; i++){\r\n            let item = list[i];\r\n            if (_.isFunction(this.leftTreeConfig.isDragable)) {\r\n              item.draggable = this.leftTreeConfig.isDragable(item);\r\n            }\r\n            else {\r\n              item.draggable = true\r\n            }\r\n            if (_.isFunction(this.leftTreeConfig.isUser)) {\r\n              item.realUser = this.leftTreeConfig.isUser(item);\r\n              if (item.realUser) {\r\n                orderPerson.push(item);\r\n                personObj[item[this.personIdAlias]] = item\r\n              }\r\n            }\r\n            else {\r\n              item.realUser = true;\r\n              orderPerson.push(item);\r\n              personObj[item[this.personIdAlias]] = item\r\n            }\r\n            if (_.isArray(item[this.childrenAlias]) && item[this.childrenAlias].length > 0) {\r\n              recurData(item[this.childrenAlias]);\r\n            }\r\n          }\r\n          return list;\r\n        };\r\n        this.list = recurData(result);\r\n        \r\n        this.orderPerson = orderPerson;\r\n        this.$emit(\"update:personObj\", personObj)\r\n  \r\n        //添加draggable交互\r\n        this.$nextTick(() => {\r\n          this.$refs.leftTree.filter()\r\n          this.createInteraction();\r\n          this.listenAutoSeat();\r\n        });\r\n        \r\n      });\r\n    },\r\n    lazyLoad(node, resolve) {\r\n      const func = this.leftTreeConfig.lazyLoadFunc;\r\n      if (!_.isFunction(func)) return;\r\n      func(node, resolve);\r\n    },\r\n    createInteraction() {\r\n      const self = this;\r\n      $(\".my-tree-node.draggable\").draggable({\r\n        addClasses: false,\r\n        start(evt) {\r\n          console.log(\"ss\")\r\n        },\r\n        helper() {\r\n          let nodes;\r\n          if (!self.openMultipleChoose) {\r\n            let personId = $(this).data(\"id\");\r\n            let node = self.$refs[\"leftTree\"].getNode(personId);\r\n            nodes = getPersonNode(node);\r\n          } else {\r\n            nodes = self.$refs[\"leftTree\"].getCheckedNodes(true);   //nodes只包含叶子节点\r\n            nodes = nodes.filter(a => a.realUser && !a[\"sys_seated\"]);\r\n          }\r\n\r\n          if (nodes?.length > 0) {\r\n            let str = `<div class=\"drag-item\">`;\r\n            nodes.forEach(a => {\r\n              str += `<span data-id=${a[self.personIdAlias]}>${a[self.labelAlias]}</span>`;\r\n            });\r\n            str += `</div>`;\r\n            return $(str);\r\n          }\r\n          return $(`<div class=\"drag-item\" empty-person=\"true\">没有可以排座的用户</div>`)\r\n        },\r\n        cursor: \"default\",\r\n        cursorAt: {\r\n          top: -5,\r\n          left: -5\r\n        },\r\n        stop(evt, ui) {\r\n\r\n        },\r\n        revert: \"invalid\"\r\n      });\r\n    },\r\n    nodeExpand() {\r\n      this.$nextTick(() => {\r\n        this.createInteraction();\r\n      });\r\n    },\r\n    addPersonRevertListener() {\r\n      eventBus.on(eventBusEvent.PERSON_REVERT_TREE, (personId) => {\r\n        $(\".my-tree-node.draggable\").draggable(\"option\", \"revert\", true);\r\n      });\r\n    },\r\n    listenAutoSeat(){\r\n      eventBus.on(eventBusEvent.AUTO_SEAT, ()=>{\r\n        const excludePersonId = [];\r\n        const temp = []   //temp里面保存的是有人并且被锁定了的入座信息\r\n        this.relativeList.forEach(a => {\r\n          if (a.currentState.couldSeat === 2 && a.person) {\r\n            temp.push(a)\r\n            excludePersonId.push(a.person[this.personIdAlias])\r\n          }\r\n        })\r\n        \r\n        //去除被锁定的person\r\n        this.orderPerson = this.orderPerson.filter(a => !_.includes(excludePersonId, a[this.personIdAlias]))\r\n        \r\n        const temp2 = []\r\n        let i=1, k=0;\r\n        while ( k < this.orderPerson.length){\r\n          let person = this.orderPerson[k];\r\n          let seat = this.seatObj[i];\r\n          let rel = this.relativeObj[i];\r\n          if (!seat) break;\r\n          if (rel?.currentState?.couldSeat === 2){\r\n            i++;\r\n            continue;\r\n          }\r\n          if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n            let isSeatAble = this.layoutConfig.isSeatAble(seat, person)\r\n            if (!isSeatAble) {\r\n              i++\r\n              continue;\r\n            }\r\n          }\r\n          temp2.push(newRelative(seat, person))\r\n          i++;\r\n          k++;\r\n        }\r\n        \r\n        this.$emit(\"update:relativeList\", _.concat(temp, temp2))\r\n      })\r\n    },\r\n    \r\n  }\r\n};\r\n  \r\nfunction getPersonNode(node) {\r\n  console.log(node)\r\n  if (node.isLeaf){\r\n    return [node.data]\r\n  }\r\n  const result = [];\r\n  const recurse = arr => {\r\n    for (let i=0; i<arr.length; i++){\r\n      const a = arr[i];\r\n      const realUser = a.data.realUser;\r\n      const seated = a.data.sys_seated;\r\n      if (a.isLeaf && realUser && !seated) {\r\n        result.push(a.data);\r\n      }\r\n      else if (a.childNodes?.length > 0){\r\n        recurse(a.childNodes)\r\n      }\r\n    }\r\n  }\r\n  recurse(node.childNodes)\r\n  return result\r\n}\r\n  \r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./leftTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./leftTree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./leftTree.vue?vue&type=template&id=1b9fe534&\"\nimport script from \"./leftTree.vue?vue&type=script&lang=js&\"\nexport * from \"./leftTree.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('1b9fe534')) {\n      api.createRecord('1b9fe534', component.options)\n    } else {\n      api.reload('1b9fe534', component.options)\n    }\n    module.hot.accept(\"./leftTree.vue?vue&type=template&id=1b9fe534&\", function () {\n      api.rerender('1b9fe534', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView/leftTree.vue\"\nexport default component.exports","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"seat-designer-page\",\n      style: _vm.canvasCss,\n      on: {\n        click: function($event) {\n          if (\n            !$event.type.indexOf(\"key\") &&\n            _vm._k($event.keyCode, \"left\", 37, $event.key, [\n              \"Left\",\n              \"ArrowLeft\"\n            ])\n          ) {\n            return null\n          }\n          if (\"button\" in $event && $event.button !== 0) {\n            return null\n          }\n          return _vm.canvasClick.apply(null, arguments)\n        }\n      }\n    },\n    [\n      _c(\n        \"div\",\n        { style: _vm.panelSty, attrs: { id: \"panel_outer\" } },\n        [\n          _vm._t(\"seat\"),\n          _c(\"div\", {\n            staticClass: \"ds_seat_panel_bg\",\n            attrs: { id: \"panel_bg\" }\n          })\n        ],\n        2\n      ),\n      _vm._t(\"seatPop\")\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"seat-designer-page\" :style=\"canvasCss\" @click.left=\"canvasClick\">\r\n    <div id=\"panel_outer\" :style=\"panelSty\">\r\n      <slot name=\"seat\"></slot>\r\n      <div id=\"panel_bg\" class=\"ds_seat_panel_bg\"></div>\r\n    </div>\r\n    <slot name=\"seatPop\"></slot>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex';\r\n  \r\nexport default {\r\n  name: \"Canvas\",\r\n  data() {\r\n    return {}\r\n  },\r\n    \r\n  computed: {\r\n    ...mapState('seatDesign', {\r\n      compelPanelSize: \"compelPanelSize\",\r\n      panelSize: \"panelSize\",\r\n      canvasCss(state) {\r\n        const {width, height} = state.compelPanelSize;\r\n        let _wid = width ? `${width}px` : '100%';\r\n        let _hit = height ? `${height}px` : '100%';\r\n        return {width: _wid, height: _hit}\r\n      },\r\n      panelParentSize(state) {\r\n        let {width, height} = state.compelPanelSize;\r\n        width = width || $(\".seat-designer-page\").width();\r\n        height = height || $(\".seat-designer-page\").height();\r\n        return {\r\n          width: width,\r\n          height: height\r\n        }\r\n      }\r\n    }),\r\n    panelSty() {\r\n      return {\r\n        width: this.panelSize.width ? this.panelSize.width + \"px\" : \"100%\",\r\n        height: this.panelSize.height ? this.panelSize.height + \"px\" : \"100%\",\r\n        left: this.panelSize.left + \"px\",\r\n        top: this.panelSize.top + \"px\"\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    \"compelPanelSize\": {\r\n      handler({width, height}) {\r\n        const panelSize = {\r\n          width: width,\r\n          height: height,\r\n          scale: 1,\r\n          left: 0,\r\n          top: 0\r\n        }\r\n          \r\n        this.$store.commit(\"seatDesign/changePanelSize\", panelSize);\r\n      },\r\n      deep: true\r\n    },\r\n  },\r\n  mounted() {\r\n    const self = this;\r\n    $(\".seat-designer-page\")[0].addEventListener('mousewheel', self.handleScroll);\r\n      \r\n  },\r\n  methods: {\r\n    handleScroll(evt) {\r\n      if (!evt.ctrlKey) return;\r\n      const self = this;\r\n      let wheelAction = evt.wheelDelta < 0 ? \"down\" : \"up\";\r\n        \r\n      //获取鼠标在panel_outer中的位置\r\n      let pos = dsf.math.convertLocalCoordinate(\"#panel_outer\", {\r\n        x: evt.pageX,\r\n        y: evt.pageY\r\n      });\r\n        \r\n      let {width: pWid, height: pHit} = self.panelParentSize;\r\n        \r\n      //获取当前的实际宽度\r\n      let w = pWid * self.panelSize.scale;\r\n      let h = pHit * self.panelSize.scale;\r\n        \r\n      //获取鼠标位置和宽度高度的比例值\r\n      let rw = pos.x / w;\r\n      let rh = pos.y / h;\r\n        \r\n      let newS = self.panelSize.scale;\r\n      if (wheelAction === \"up\") {\r\n        newS += 0.1;\r\n      } else if (wheelAction === \"down\") {\r\n        newS -= 0.1;\r\n      }\r\n        \r\n      //缩放比例最小0.1\r\n      if (newS >= 0.1) {\r\n        let panel = $(\"#panel_outer\");\r\n        let sw = pWid * newS;\r\n        let sh = pHit * newS;\r\n        let l = panel.position().left + pos.x - (sw * rw);\r\n        let t = panel.position().top + pos.y - (sh * rh);\r\n        const panelSize = {\r\n          scale: Math.round(newS * 10) / 10,\r\n          width: Math.floor(sw),\r\n          height: Math.floor(sh),\r\n          left: Math.floor(l),\r\n          top: Math.floor(t)\r\n        };\r\n        self.$store.commit(\"seatDesign/changePanelSize\", panelSize);\r\n      }\r\n        \r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n    },\r\n    canvasClick(evt) {\r\n      const self = this;\r\n      self.$store.commit(\"seatDesign/changeActiveId\", \"\");\r\n    },\r\n  },\r\n    \r\n}\r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./canvas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./canvas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./canvas.vue?vue&type=template&id=83fd798e&\"\nimport script from \"./canvas.vue?vue&type=script&lang=js&\"\nexport * from \"./canvas.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('83fd798e')) {\n      api.createRecord('83fd798e', component.options)\n    } else {\n      api.reload('83fd798e', component.options)\n    }\n    module.hot.accept(\"./canvas.vue?vue&type=template&id=83fd798e&\", function () {\n      api.rerender('83fd798e', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView/canvas.vue\"\nexport default component.exports","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"seat-item-container normal\" },\n    [\n      _vm._l(_vm.myItems, function(item, it) {\n        return _c(\n          \"div\",\n          {\n            key: item.id,\n            staticClass: \"seat-box\",\n            class: _vm.realSeatCss(item),\n            style: _vm.getItemSty(item),\n            attrs: {\n              \"data-id\": item.id,\n              \"data-belong\": item.type,\n              \"data-num\": item.seatNum,\n              \"exist-person\": !!item.person,\n              \"data-person\": item.person ? item.person[_vm.personNameAlias] : \"\"\n            },\n            on: {\n              contextmenu: function($event) {\n                return _vm.popMenu($event, item)\n              },\n              click: function($event) {\n                if (\n                  !$event.type.indexOf(\"key\") &&\n                  _vm._k($event.keyCode, \"left\", 37, $event.key, [\n                    \"Left\",\n                    \"ArrowLeft\"\n                  ])\n                ) {\n                  return null\n                }\n                if (\"button\" in $event && $event.button !== 0) {\n                  return null\n                }\n                return _vm.mulChooseSeat($event, item)\n              }\n            }\n          },\n          [\n            _c(\n              \"div\",\n              { staticClass: \"seat\" },\n              [\n                item.person\n                  ? [\n                      item.width * _vm.panelSize.scale > 60\n                        ? _c(\"p\", { staticClass: \"person\" }, [\n                            _vm._v(_vm._s(item.person[_vm.personNameAlias]))\n                          ])\n                        : _c(\"p\", {\n                            staticClass: \"person\",\n                            domProps: {\n                              textContent: _vm._s(\n                                item.person[_vm.personNameAlias].charAt(0)\n                              )\n                            }\n                          })\n                    ]\n                  : _c(\"p\", [_vm._v(_vm._s(item.seatTxt))])\n              ],\n              2\n            )\n          ]\n        )\n      }),\n      _vm._l(_vm.myGroups, function(group, g) {\n        return _c(\n          \"div\",\n          {\n            key: group.id,\n            staticClass: \"group-box\",\n            class: { hideText: group.showText === 2 },\n            style: _vm.getItemSty(group)\n          },\n          [\n            _c(\n              \"div\",\n              { staticClass: \"group\" },\n              _vm._l(group.member, function(member, m) {\n                return _c(\n                  \"div\",\n                  {\n                    key: member.id,\n                    staticClass: \"member\",\n                    class: _vm.realSeatCss(member),\n                    style: _vm.getMemberSty(member),\n                    attrs: {\n                      \"data-id\": member.id,\n                      \"data-pid\": group.id,\n                      \"data-num\": member.seatNum,\n                      \"exist-person\": !!member.person,\n                      \"data-person\": member.person\n                        ? member.person[_vm.personNameAlias]\n                        : \"\",\n                      \"data-belong\": \"group\"\n                    },\n                    on: {\n                      contextmenu: function($event) {\n                        return _vm.popMenu($event, group, member)\n                      },\n                      click: function($event) {\n                        if (\n                          !$event.type.indexOf(\"key\") &&\n                          _vm._k($event.keyCode, \"left\", 37, $event.key, [\n                            \"Left\",\n                            \"ArrowLeft\"\n                          ])\n                        ) {\n                          return null\n                        }\n                        if (\"button\" in $event && $event.button !== 0) {\n                          return null\n                        }\n                        return _vm.mulChooseSeat($event, member, group)\n                      }\n                    }\n                  },\n                  [\n                    member.person\n                      ? [\n                          member.width * _vm.panelSize.scale > 60\n                            ? _c(\"p\", { staticClass: \"person\" }, [\n                                _vm._v(\n                                  _vm._s(member.person[_vm.personNameAlias])\n                                )\n                              ])\n                            : _c(\"p\", {\n                                staticClass: \"person\",\n                                domProps: {\n                                  textContent: _vm._s(\n                                    member.person[_vm.personNameAlias].charAt(0)\n                                  )\n                                }\n                              })\n                        ]\n                      : _c(\"p\", [_vm._v(_vm._s(member.seatTxt))])\n                  ],\n                  2\n                )\n              }),\n              0\n            )\n          ]\n        )\n      }),\n      _c(\n        \"el-dialog\",\n        {\n          attrs: {\n            title: \"提示\",\n            visible: _vm.confirm.visible,\n            \"append-to-body\": true,\n            width: \"30%\"\n          },\n          on: {\n            \"update:visible\": function($event) {\n              return _vm.$set(_vm.confirm, \"visible\", $event)\n            }\n          }\n        },\n        [\n          _c(\"div\", [_vm._v(_vm._s(_vm.confirm.msg))]),\n          _c(\n            \"div\",\n            {\n              staticClass: \"dialog-footer\",\n              attrs: { slot: \"footer\" },\n              slot: \"footer\"\n            },\n            [\n              _c(\"el-button\", { on: { click: _vm.seatCover } }, [\n                _vm._v(\"覆盖\")\n              ]),\n              _c(\"el-button\", { on: { click: _vm.seatInsert } }, [\n                _vm._v(\"插入\")\n              ]),\n              _c(\"el-button\", { on: { click: _vm.seatCancel } }, [\n                _vm._v(\"取消\")\n              ])\n            ],\n            1\n          )\n        ]\n      )\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"seat-item-container normal\">\r\n    <!--seat-->\r\n    <div\r\n      v-for=\"(item, it) in myItems\"\r\n      :key=\"item.id\"\r\n      class=\"seat-box\"\r\n      :style=\"getItemSty(item)\"\r\n      :class=\"realSeatCss(item)\"\r\n      :data-id=\"item.id\"\r\n      :data-belong=\"item.type\"\r\n      :data-num=\"item.seatNum\"\r\n      :exist-person=\"!!item.person\"\r\n      :data-person=\"item.person? item.person[personNameAlias]: ''\"\r\n      @click.right=\"popMenu($event, item)\"\r\n      @click.left=\"mulChooseSeat($event, item)\"\r\n    >\r\n      <div class=\"seat\">\r\n        <template v-if=\"item.person\">\r\n          <p v-if=\"item.width*panelSize.scale > 60\" class=\"person\">{{ item.person[personNameAlias] }}</p>\r\n          <p v-else class=\"person\" v-text=\"item.person[personNameAlias].charAt(0)\"></p>\r\n        </template>\r\n        <p v-else>{{ item.seatTxt }}</p>\r\n      </div>\r\n    </div>\r\n    \r\n    <!--group-->\r\n    <div\r\n      v-for=\"(group, g) in myGroups\"\r\n      :key=\"group.id\"\r\n      class=\"group-box\"\r\n      :class=\"{hideText: group.showText === 2}\"\r\n      :style=\"getItemSty(group)\"\r\n    >\r\n      <div class=\"group\">\r\n        <div\r\n          v-for=\"(member, m) in group.member\"\r\n          :key=\"member.id\"\r\n          :style=\"getMemberSty(member)\"\r\n          class=\"member\"\r\n          :class=\"realSeatCss(member)\"\r\n          :data-id=\"member.id\"\r\n          :data-pid=\"group.id\"\r\n          :data-num=\"member.seatNum\"\r\n          :exist-person=\"!!member.person\"\r\n          :data-person=\"member.person? member.person[personNameAlias]: ''\"\r\n          data-belong=\"group\"\r\n          @click.right=\"popMenu($event, group, member)\"\r\n          @click.left=\"mulChooseSeat($event, member, group)\"\r\n        >\r\n          <template v-if=\"member.person\">\r\n            <p v-if=\"member.width*panelSize.scale > 60\" class=\"person\">{{ member.person[personNameAlias] }}</p>\r\n            <p v-else class=\"person\" v-text=\"member.person[personNameAlias].charAt(0)\"></p>\r\n          </template>\r\n          \r\n          <p v-else>{{ member.seatTxt }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!--confirm-->\r\n    <el-dialog\r\n      title=\"提示\"\r\n      :visible.sync=\"confirm.visible\"\r\n      :append-to-body=\"true\"\r\n      width=\"30%\">\r\n      <div>{{confirm.msg}}</div>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"seatCover\">覆盖</el-button>\r\n        <el-button @click=\"seatInsert\">插入</el-button>\r\n        <el-button @click=\"seatCancel\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex';\r\nimport eventBus from \"_platform/designer/seat/util/eventBus\";\r\nimport {eventBusEvent} from \"_platform/designer/seat/constant\";\r\nimport {newRelative} from \"_platform/designer/seat/func\"\r\n  \r\nexport default {\r\n  name: \"SeatItem\",\r\n  inject: ['layoutConfigPointer', 'leftTreeConfigPointer'],\r\n  props: {\r\n    //快捷键\r\n    keyStack: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n    //所有座位\r\n    items: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n    //所有组\r\n    groups: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n      \r\n    seatObj: {\r\n      type: Object,\r\n      default() {\r\n        return null\r\n      }\r\n    },\r\n      \r\n    //所有排座情况\r\n    relativeList: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n      \r\n    //多个选中的座位\r\n    chosenItems: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n      \r\n    //所有可以入座的人员\r\n    personObj: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      }\r\n    },\r\n      \r\n    relativeObj: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      confirm: {\r\n        visible: false,\r\n        msg: '',\r\n        type: ''\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(\"seatDesign\", {\r\n      panelSize: \"panelSize\",\r\n      activeId: \"activeId\",\r\n    }),\r\n    myItems() {\r\n      const arr = _.cloneDeep(this.items);\r\n      for (let i = 0; i < this.relativeList.length; i++) {\r\n        for (let j = 0; j < arr.length; j++) {\r\n          let rel = this.relativeList[i];\r\n          let seat = arr[j];\r\n          if (rel.id !== seat.id) continue;\r\n          Object.assign(seat, rel);\r\n        }\r\n      }\r\n      return arr;\r\n    },\r\n    myGroups() {\r\n      const arr = _.cloneDeep(this.groups);\r\n      let haveReaded = false;\r\n      for (let i = 0; i < this.relativeList.length; i++) {\r\n        haveReaded = false;\r\n        for (let j = 0; j < arr.length; j++) {\r\n          if (haveReaded) break;\r\n          let rel = this.relativeList[i];\r\n          let group = arr[j];\r\n          if (group.id !== rel.pid) continue;\r\n          for (let k = 0; k < group.member.length; k++) {\r\n            let seat = group.member[k];\r\n            if (seat.id !== rel.id) continue;\r\n            Object.assign(seat, rel);\r\n            haveReaded = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      return arr;\r\n    },\r\n    personNameAlias() {\r\n      return this.leftTreeConfig.leafProps.label\r\n    },\r\n    personIdAlias() {\r\n      return this.leftTreeConfig.leafProps.id\r\n    },\r\n  },\r\n  watch: {\r\n    \"panelSize.scale\"() {\r\n      this.items.forEach(el => {\r\n        el.isFrozenSty = false\r\n      })\r\n      this.groups.forEach(el => {\r\n        el.isFrozenSty = false;\r\n        el.isFrozenMemberSty = false\r\n      })\r\n    },\r\n    // relativeList: {\r\n    //   handler(){\r\n    //     this.showPeopleInteraction()\r\n    //   },\r\n    //   deep: true\r\n    // },\r\n    chosenItems(currentVal) {\r\n      //清空所有chosen css(初始化)\r\n      $(\"i.anchor\").remove();\r\n      $(\".chosen\").removeClass(\"chosen\");\r\n        \r\n      //根据当前的 chosenItems 重新渲染\r\n      const jud = {}, anchor = {};\r\n      currentVal.forEach(a => {\r\n        jud[a.id] = a;\r\n        a.ischosenRreference && (anchor[a.id] = a);\r\n      })\r\n      $(\".member\").each(function () {\r\n        let index = $(this).data(\"id\");\r\n        jud[index] && $(this).addClass(\"chosen\")\r\n        anchor[index] && $(this).append(\"<i class='anchor'></i>\")\r\n      })\r\n      $(\".seat-box\").each(function () {\r\n        let index = $(this).data(\"id\");\r\n        jud[index] && $(this).addClass(\"chosen\")\r\n      })\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    $(document).off(\"mouseup.scaleSeatItem\");\r\n    $(document).off(\"mousemove.scaleSeatItem\");\r\n  },\r\n  mounted() {\r\n    eventBus.on(eventBusEvent.KEY_CTRL_D, () => {\r\n        \r\n    })\r\n    eventBus.on(eventBusEvent.KEY_DELETE, () => {\r\n        \r\n    })\r\n    eventBus.listen(eventBusEvent.BODY_EMPTY_CLICK, () => {\r\n      console.log(\"BODY_EMPTY_CLICK\")\r\n      //清除所有的 shift参考锚点\r\n      this.chosenItems.forEach(a => {\r\n        a.ischosenRreference = false\r\n      });\r\n      this.$emit(\"update:chosenItems\", [])\r\n    })\r\n    eventBus.listen(eventBusEvent.CONFIG_FILE_LOADED, ()=>{\r\n      this.layoutConfig = this.layoutConfigPointer();\r\n      this.leftTreeConfig = this.leftTreeConfigPointer();\r\n      this.createInteraction()\r\n    })\r\n  },\r\n  methods: {\r\n    mulChooseSeat(evt, item, group) {\r\n      if (!this.layoutConfig.openMultipleChoose) return;\r\n      $(\".seat-item-container .person-info\").remove();    //移除人名浮动提示框\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n      if (this.keyStack[0] !== \"ctrl\" && this.keyStack[0] !== \"shift\") {\r\n        let chosenIndex = this.chosenItems.findIndex(a => a.id === item.id);\r\n        if (chosenIndex === -1) {\r\n          eventBus.dispatch(eventBusEvent.BODY_EMPTY_CLICK)\r\n          return;\r\n        }\r\n      }\r\n        \r\n      eventBus.emit(eventBusEvent.LEFT_CLICK_SEAT);\r\n        \r\n      if (this.keyStack[0] === \"ctrl\") {\r\n        let index = this.chosenItems.findIndex(a => a.id === item.id);\r\n        if (index !== -1) {\r\n          this.chosenItems.splice(index, 1);\r\n          if (item.ischosenRreference) item.ischosenRreference = false;\r\n        } else {\r\n          this.chosenItems.push(item);\r\n        }\r\n      } else if (this.keyStack[0] === \"shift\") {\r\n        if (!group) {\r\n          //清除所有的 shift参考锚点\r\n          this.chosenItems.forEach(a => {\r\n            a.ischosenRreference = false\r\n          });\r\n          this.$emit(\"update:chosenItems\", [item]);\r\n        } else {\r\n          const arr = this.chosenItems.filter(a => a.parentId === group.id)\r\n          if (arr.length === 0) {\r\n            item.ischosenRreference = true;   //此点为参考点\r\n            this.chosenItems.push(item);\r\n          } else {\r\n            const lastObj = arr.find(a => a.ischosenRreference);    //返回第一次选中的参考点\r\n            //如果group里面从来没有使用 shift 选中过, 则清空被选中的\r\n            if (!lastObj) {\r\n              const cleanArr = _.differenceBy(this.chosenItems, arr, \"id\");\r\n              item.ischosenRreference = true;\r\n              cleanArr.push(item)\r\n              this.$emit(\"update:chosenItems\", cleanArr);\r\n            } else {\r\n              //获取当前选中点和group里面选中的参考点\r\n              let currentIndex, lastObjIndex;\r\n              group.member.some((a, index) => {\r\n                if (currentIndex && lastObjIndex) return true;\r\n                item.id === a.id && (currentIndex = index)\r\n                lastObj.id === a.id && (lastObjIndex = index)\r\n              })\r\n                \r\n              //清空当前选中group 里面的所有项\r\n              const cleanArr = this.chosenItems.filter(a => a.parentId !== group.id)\r\n              if (currentIndex === lastObjIndex) {\r\n                item.ischosenRreference = false;  //取消参考点\r\n                this.$emit(\"update:chosenItems\", cleanArr);\r\n              } else {\r\n                let temp = currentIndex < lastObjIndex ?\r\n                  group.member.slice(currentIndex, lastObjIndex + 1) :\r\n                  group.member.slice(lastObjIndex, currentIndex + 1);\r\n                  \r\n                const result = cleanArr.concat(temp);\r\n                this.$emit(\"update:chosenItems\", result);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    realSeatCss(item) {\r\n      return [\r\n        {\r\n          realSeat: !/^sec/.test(item.type),\r\n          hideText: item.showText === 2\r\n        }\r\n      ]\r\n    },\r\n    getItemSty(item) {\r\n      const sty = {\r\n        width: item.width * this.panelSize.scale + \"px\",\r\n        height: item.height * this.panelSize.scale + \"px\",\r\n        left: item.left * this.panelSize.scale + \"px\",\r\n        top: item.top * this.panelSize.scale + \"px\",\r\n        transform: `rotate(${item.angle}deg)`\r\n      }\r\n      if (item.type !== \"group\") {\r\n        sty.background = getBgSty(item);\r\n      }\r\n      item.style = sty;\r\n      return sty\r\n    },\r\n    getMemberSty(member) {\r\n      const sty = {\r\n        width: member.width * this.panelSize.scale + \"px\",\r\n        height: member.height * this.panelSize.scale + \"px\",\r\n        left: member.left * this.panelSize.scale + \"px\",\r\n        top: member.top * this.panelSize.scale + \"px\",\r\n      }\r\n      sty.background = getBgSty(member);\r\n      return sty\r\n    },\r\n    popMenu(evt, item, member) {\r\n      if (/^sec_/.test(item.type) || evt.which !== 3) return;\r\n        \r\n      const currentItem = item.type !== \"group\" ? item : member;\r\n        \r\n      let chosenIndex = this.chosenItems.findIndex(a => a.id === currentItem.id)\r\n      if (chosenIndex === -1) {\r\n        eventBus.dispatch(eventBusEvent.BODY_EMPTY_CLICK);\r\n      }\r\n        \r\n      $(\".active\").removeClass(\"active\");\r\n      const targetDOM = getDOM(evt, !member);\r\n      $(targetDOM).addClass(\"active\");\r\n        \r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      let downPos = dsf.math.convertLocalCoordinate('.seat-designer-page', {x: evt.pageX, y: evt.pageY});\r\n      setRect2Active.call(this, item);\r\n      eventBus.emit(eventBusEvent.SEAT_POP, {\r\n        position: {\r\n          ...downPos\r\n        },\r\n        currentItem: currentItem\r\n      })\r\n    },\r\n    createInteraction() {\r\n      this.$nextTick(() => {\r\n        const self = this;\r\n        $(\".seat-item-container .realSeat\").droppable({\r\n          addClasses: false,\r\n          tolerance: \"pointer\",\r\n          over(evt, ui) {\r\n            console.log(\"droppable over\")\r\n            const seatDOM = $(evt.target);\r\n            if (seatDOM.hasClass(\"realSeat\")) {\r\n              seatDOM.css({\"box-shadow\": \"0 0 5px inset #409eff\"})\r\n            }\r\n          },\r\n          drop(evt, ui) {\r\n            const seatDOM = $(evt.target);\r\n            seatDOM.css(\"box-shadow\", \"none\");\r\n\r\n            if (ui.helper.attr(\"empty-person\")) return; //没有可以入座的人员则直接返回\r\n\r\n            if (seatDOM.data(\"belong\") === \"group\") {\r\n              const groupContainer = self.myGroups.find(a => a.id === seatDOM.data(\"pid\"));\r\n              self.dropSeatObj = groupContainer.member.find(a => a.id === seatDOM.data(\"id\"));\r\n            } else {\r\n              self.dropSeatObj = self.myItems.find(a => a.id === seatDOM.data(\"id\"));\r\n            }\r\n\r\n            const persons = [];\r\n            ui.helper.children(\"span\").each(function () {\r\n              persons.push($(this).data(\"id\"))\r\n            })\r\n            self.mPersonIds = persons;\r\n            multiple2seated.call(self);\r\n          },\r\n          out(evt, ui) {\r\n            const seatDOM = $(evt.target);\r\n            seatDOM.css(\"box-shadow\", \"none\");\r\n          }\r\n        })\r\n\r\n        $(\".seat-item-container\").on(\"mouseenter\", \"[exist-person]\", function (event) {\r\n          if ($(this).hasClass(\"chosen\")) return;\r\n          if ($(this).find(\".person-info\")?.length > 0) return;\r\n          let personName = $(this).attr(\"data-person\");\r\n          $(this).append(`<div class=\"person-info\">${personName} <i></i></div>`)\r\n        })\r\n\r\n        $(\".seat-item-container\").on(\"mouseleave\", \"[exist-person]\", function () {\r\n          $(this).find(\".person-info\").remove()\r\n        })\r\n\r\n      })\r\n    },\r\n    seatCover() {\r\n      let startSeatNum = this.dropSeatObj.seatNum;\r\n      let i = 0, k = 0;\r\n      while (k < this.mPersonIds.length) {\r\n        let rel = this.relativeObj[startSeatNum + i];\r\n        let person = this.personObj[this.mPersonIds[k]];\r\n        let seat = this.seatObj[startSeatNum + i]\r\n        if (!seat) break;\r\n          \r\n        if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n          let isSeatAble = this.layoutConfig.isSeatAble(seat, person)\r\n          if (!isSeatAble) {\r\n            i++\r\n            continue;\r\n          }\r\n        }\r\n          \r\n        if (rel) {\r\n          if (rel.currentState.couldSeat === 2) {\r\n            i++\r\n            continue;\r\n          }\r\n          rel.person = person\r\n          rel.currentState = seat.stateList[1];\r\n        } else {\r\n          this.relativeList.push(newRelative(seat, person))\r\n        }\r\n        i++;\r\n        k++;\r\n      }\r\n        \r\n      this.confirm.visible = false;\r\n    },\r\n    seatInsert() {\r\n    },\r\n    seatCancel() {\r\n      this.dropSeatObj = null;\r\n      this.mPersonIds = null;\r\n      this.mPersonid = null;\r\n      this.confirm.visible = false;\r\n    },\r\n    popConfirm(msg) {\r\n      this.confirm = {\r\n        visible: true,\r\n        msg: \"检测到您需要入座的座位上已经存在其他人员，您希望如何处理？\",\r\n        type: \"warning\"\r\n      }\r\n    },\r\n  },\r\n}\r\n  \r\n//获取选中的DOM对象\r\nfunction getDOM(evt, isSeatBox) {\r\n  const temp = $(evt.target);\r\n  if (isSeatBox) {\r\n    if (temp.hasClass(\"seat-box\")) return temp;\r\n    return temp.parents(\".seat-box\").eq(0);\r\n  } else {\r\n    if (temp.hasClass(\"member\")) return temp;\r\n    return temp.parents(\".member\").eq(0)\r\n  }\r\n}\r\n  \r\n//多个节点排座\r\nfunction multiple2seated() {\r\n  const personIds = this.mPersonIds;\r\n  //如果座位启动了多选框\r\n  if (this.chosenItems?.length > 0) {\r\n    const index = this.chosenItems.findIndex(a => a.id === this.dropSeatObj.id);\r\n    //如果人员未放置在多选框\r\n    if (index === -1) {\r\n      dsf.layer.confirm(\"您已选中了部分座位，只有将人员拖入选中的座位中，才能开始依序号排座\")\r\n      return\r\n    }\r\n      \r\n    this.chosenItems.sort((a, b) => a.seatNum - b.seatNum);\r\n      \r\n    let len = 0, seatObj = {};\r\n    for (let seat of this.chosenItems) {\r\n      if (seat?.currentState?.couldSeat === 2) continue;\r\n      if (seat.person) {\r\n        this.popConfirm();\r\n        return;\r\n      }\r\n        \r\n      let person = this.personObj[personIds[len]];\r\n      if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n        let isSeatAble = this.layoutConfig.isSeatAble(seat, person)\r\n        if (!isSeatAble) continue;\r\n      }\r\n      seatObj[seat.id] = {\r\n        seat: seat,\r\n        person: person\r\n      }\r\n      len += 1;\r\n      if (len === personIds.length) break;\r\n    }\r\n      \r\n    simpleInsertSeat.call(this, seatObj);\r\n  }\r\n  //如果座位没有开启多选框\r\n  else {\r\n    let startNum = this.dropSeatObj.seatNum;\r\n    for (let i = 0; i < personIds.length; i++) {\r\n      if (this.relativeObj[startNum + i]?.person) {\r\n        this.popConfirm();\r\n        return;\r\n      }\r\n    }\r\n      \r\n    let i = 0, k = 0;\r\n    while (k < personIds.length) {\r\n      let person = this.personObj[personIds[k]];\r\n      let rel = this.relativeObj[startNum + i];\r\n      let seat = this.seatObj[startNum + i];\r\n      if (!seat) return;  //如果已经没有座位了\r\n      if (rel?.currentState?.couldSeat === 2) {\r\n        i++;\r\n        continue;\r\n      }\r\n        \r\n      if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n        let isSeatAble = this.layoutConfig.isSeatAble(seat, person);\r\n        if (!isSeatAble) {\r\n          i++\r\n          continue;\r\n        }\r\n      }\r\n        \r\n      if (rel) {\r\n        rel.person = person;\r\n        rel.currentState = seat.stateList[1];\r\n      } else {\r\n        this.relativeList.push(newRelative(seat, person))\r\n      }\r\n      i++;\r\n      k++;\r\n    }\r\n  }\r\n}\r\n  \r\n  \r\nfunction simpleInsertSeat(seatObj) {\r\n  for (let i in seatObj) {\r\n    let seat = seatObj[i].seat;\r\n    let person = seatObj[i].person\r\n    this.relativeList.push(newRelative(seat, person))\r\n  }\r\n    \r\n  // 更新选中的items\r\n  for (let i = 0; i < this.chosenItems.length; i++) {\r\n    let a = this.chosenItems[i];\r\n    if (!seatObj[a.id]) continue;\r\n      \r\n    let seat = seatObj[a.id].seat;\r\n    let person = seatObj[a.id].person;\r\n    a.currentState = seat.stateList[1];\r\n    a.person = person\r\n  }\r\n}\r\n  \r\n//树节点排座\r\nfunction treeNode2seated(personId) {\r\n    \r\n}\r\n  \r\n//激活单个座位\r\nfunction setRect2Active(seat) {\r\n  if (this.activeId === seat.id) return;\r\n  //清空已选的座位\r\n  this.$store.commit(\"seatDesign/changeActiveId\", seat.id);\r\n}\r\n  \r\n//获取seat背景的样式\r\nfunction getBgSty(obj) {\r\n  let url;\r\n  //如果只是辅助对象\r\n  if (/^sec_/.test(obj.type)) {\r\n    url = dsf.url.getAbsolutePath(obj.bgImg);\r\n  } else {\r\n    if (obj.currentState) {\r\n      if (!obj.currentState.img) return \"none\"\r\n      url = dsf.url.getAbsolutePath(obj.currentState.img);\r\n    } else {\r\n      const judge = _.isArray(obj.stateList) && obj.stateList[0] && obj.stateList[0].img;\r\n      if (!judge) return \"none\"\r\n      url = dsf.url.getAbsolutePath(obj.stateList[0].img)\r\n    }\r\n  }\r\n  return `center / contain no-repeat url(${url})`\r\n}\r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./seatItem.vue?vue&type=template&id=562ca259&\"\nimport script from \"./seatItem.vue?vue&type=script&lang=js&\"\nexport * from \"./seatItem.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('562ca259')) {\n      api.createRecord('562ca259', component.options)\n    } else {\n      api.reload('562ca259', component.options)\n    }\n    module.hot.accept(\"./seatItem.vue?vue&type=template&id=562ca259&\", function () {\n      api.rerender('562ca259', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView/seatItem.vue\"\nexport default component.exports","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      directives: [\n        {\n          name: \"show\",\n          rawName: \"v-show\",\n          value: _vm.popShow,\n          expression: \"popShow\"\n        }\n      ],\n      staticClass: \"seat-pop-box\",\n      style: _vm.sty\n    },\n    [\n      _c(\n        \"ul\",\n        [\n          _vm.isExistPerson\n            ? _c(\"li\", { on: { click: _vm.removePerson } }, [\n                _vm._v(\"移除占用\")\n              ])\n            : _vm._e(),\n          _vm.isExistPerson\n            ? _c(\"li\", { on: { click: _vm.splicePerson } }, [\n                _vm._v(\"移除占用并补位\")\n              ])\n            : _vm._e(),\n          _vm.couldSeat !== 1\n            ? _c(\n                \"li\",\n                {\n                  on: {\n                    click: function($event) {\n                      if (\n                        !$event.type.indexOf(\"key\") &&\n                        _vm._k($event.keyCode, \"left\", 37, $event.key, [\n                          \"Left\",\n                          \"ArrowLeft\"\n                        ])\n                      ) {\n                        return null\n                      }\n                      if (\"button\" in $event && $event.button !== 0) {\n                        return null\n                      }\n                      $event.stopPropagation()\n                      return _vm.seat2work.apply(null, arguments)\n                    }\n                  }\n                },\n                [_vm._v(\"启用\")]\n              )\n            : _vm._e(),\n          _vm._l(_vm.otherList, function(item, it) {\n            return _c(\n              \"li\",\n              {\n                key: it,\n                on: {\n                  click: function($event) {\n                    if (\n                      !$event.type.indexOf(\"key\") &&\n                      _vm._k($event.keyCode, \"left\", 37, $event.key, [\n                        \"Left\",\n                        \"ArrowLeft\"\n                      ])\n                    ) {\n                      return null\n                    }\n                    if (\"button\" in $event && $event.button !== 0) {\n                      return null\n                    }\n                    $event.stopPropagation()\n                    return _vm.clickOther(item)\n                  }\n                }\n              },\n              [_vm._v(_vm._s(item.statusText))]\n            )\n          })\n        ],\n        2\n      ),\n      _c(\"el-dialog\", {\n        attrs: {\n          visible: _vm.dialogVisible,\n          title: \"信息\",\n          width: \"300px\",\n          modal: false,\n          \"append-to-body\": true\n        },\n        on: {\n          \"update:visible\": function($event) {\n            _vm.dialogVisible = $event\n          }\n        }\n      })\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div v-show=\"popShow\" class=\"seat-pop-box\" :style=\"sty\">\r\n    <ul>\r\n      <li v-if=\"isExistPerson\" @click=\"removePerson\">移除占用</li>\r\n      <li v-if=\"isExistPerson\" @click=\"splicePerson\">移除占用并补位</li>\r\n      <li v-if=\"couldSeat !== 1\" @click.left.stop=\"seat2work\">启用</li>\r\n      <li v-for=\"(item, it) in otherList\" :key=\"it\" @click.left.stop=\"clickOther(item)\">{{ item.statusText }}</li>\r\n    </ul>\r\n    \r\n    <el-dialog :visible.sync=\"dialogVisible\" title=\"信息\" width=\"300px\" :modal=\"false\" :append-to-body=\"true\">\r\n    \r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport eventBus from \"_platform/designer/seat/util/eventBus\";\r\nimport {eventBusEvent} from \"_platform/designer/seat/constant\";\r\nimport {newRelative} from \"_platform/designer/seat/func\";\r\n  \r\nexport default {\r\n  name: \"SeatPop\",\r\n  inject: ['layoutConfigPointer', 'leftTreeConfigPointer'],\r\n  props: {\r\n    relativeList: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n    chosenItems: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      }\r\n    },\r\n    seatObj: {\r\n      type: Object,\r\n      default() {\r\n        return null\r\n      }\r\n    },\r\n    relativeObj: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      currentItem: {\r\n        currentState: {},\r\n        stateList: []\r\n      },\r\n      position: {},\r\n      popShow: false,\r\n      state: null,  //当前座位的状态\r\n      couldSeat: 1, //当前座位是否可以入座 1可以  2不行\r\n    }\r\n  },\r\n  computed: {\r\n    sty() {\r\n      return {\r\n        left: this.position.x + \"px\",\r\n        top: this.position.y + \"px\"\r\n      }\r\n    },\r\n    otherList() {\r\n      const all = this.currentItem.stateList.slice(2);\r\n      if (this.state) {\r\n        let index = all.findIndex(a => a.statusValue === this.state)\r\n        if (index !== -1) all.splice(index, 1);\r\n      }\r\n      return all\r\n    },\r\n    personIdAlias() {\r\n      return this.leftTreeConfig.leafProps.id\r\n    },\r\n    isExistPerson() {\r\n      if (!this.chosenItems || this.chosenItems.length === 0) {\r\n        return !!this.currentItem.person && this.currentItem.currentState.statusValue !== 3\r\n      } else {\r\n        return this.chosenItems.some(item => !!item.person);\r\n      }\r\n    },\r\n    layoutConfig(){\r\n      return this.layoutConfigPointer()\r\n    },\r\n    leftTreeConfig(){\r\n      return this.leftTreeConfigPointer()\r\n    }\r\n  },\r\n  mounted() {\r\n    eventBus.on(eventBusEvent.SEAT_POP, data => {\r\n      Object.assign(this, data);    //这里给this.currentItem 赋值\r\n      const seatState = data.currentItem.currentState;\r\n      if (seatState) {\r\n        this.couldSeat = seatState.couldSeat;\r\n        this.state = seatState.statusValue;\r\n      } else {\r\n        this.couldSeat = 1;\r\n        this.state = null;\r\n      }\r\n        \r\n      this.popShow = true;\r\n    })\r\n    eventBus.on(eventBusEvent.LEFT_CLICK_SEAT, () => {\r\n      this.popShow = false;\r\n      $(\".active\").removeClass(\"active\")\r\n    })\r\n    eventBus.listen(eventBusEvent.BODY_EMPTY_CLICK, () => {\r\n      this.popShow = false;\r\n      $(\".active\").removeClass(\"active\")\r\n    })\r\n  },\r\n  methods: {\r\n    popDialog(evt) {\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n      this.popShow = true;\r\n      this.dialogVisible = true\r\n    },\r\n    clickOther(currentState) {\r\n      if (!this.chosenItems || this.chosenItems.length === 0) {\r\n        const rel = this.relativeObj[this.currentItem.seatNum];\r\n        _singleSetStatus.call(this, rel, this.currentItem, currentState)\r\n      } else {\r\n        for (let i = 0; i < this.chosenItems.length; i++) {\r\n          let item = this.chosenItems[i];\r\n          let rel = this.relativeObj[item.seatNum];\r\n          _singleSetStatus.call(this, rel, item, currentState)\r\n        }\r\n        this.$emit(\"update:chosenItems\", [])\r\n      }\r\n      this.popShow = false;\r\n    },\r\n    seat2work() {\r\n      if (!this.chosenItems || this.chosenItems.length === 0) {\r\n        const rel = this.relativeObj[this.currentItem.seatNum];\r\n        rel.currentState = rel.person ? this.currentItem.stateList[1] : this.currentItem.stateList[0];\r\n      } else {\r\n        for (let i = 0; i < this.chosenItems.length; i++) {\r\n          let item = this.chosenItems[i];\r\n          let rel = this.relativeObj[item.seatNum];\r\n          if (!rel) continue;\r\n          rel.currentState = rel.person ? item.stateList[1] : item.stateList[0];\r\n        }\r\n        this.$emit(\"update:chosenItems\", [])\r\n      }\r\n      this.popShow = false;\r\n    },\r\n    removePerson() {\r\n      if (!this.chosenItems || this.chosenItems.length === 0) {\r\n        let rel = this.relativeObj[this.currentItem.seatNum];\r\n        if (rel.currentState.statusValue === 3) return;\r\n        rel.person = null\r\n        rel.currentState = this.currentItem.stateList[0];\r\n      } else {\r\n        for (let i = 0; i < this.chosenItems.length; i++) {\r\n          let item = this.chosenItems[i];\r\n          let rel = this.relativeObj[item.seatNum];\r\n          if (!rel || rel.currentState.statusValue === 3) continue;\r\n          rel.person = null\r\n          rel.currentState = item.stateList[0];\r\n        }\r\n      }\r\n    },\r\n    splicePerson() {\r\n      const arr = [];               //arr为可以往前补位的数据\r\n      const havePersonArr = [];     //havePersonArr为可以往前补位并且有人入座的数据\r\n      let startSeatNum;     //开始入座的座位号\r\n      if (this.chosenItems?.length > 0) {\r\n        this.chosenItems.sort((a, b) => a.seatNum - b.seatNum);\r\n        startSeatNum = this.chosenItems[0].seatNum;\r\n          \r\n        for (let num in this.relativeObj) {\r\n          let a = this.relativeObj[num];\r\n          if (num < startSeatNum || a.currentState.couldSeat === 2) continue;\r\n          arr.push(a);\r\n          let index = this.chosenItems.findIndex(b => b.id === a.id);\r\n          if (index !== -1 || !a.person) continue;\r\n          havePersonArr.push(a)\r\n        }\r\n          \r\n        //先删除这些座位\r\n        const temp = this.relativeList.filter(a => {\r\n          let index = arr.findIndex(b => b.id === a.id)\r\n          return index === -1\r\n        })\r\n        this.$emit(\"update:relativeList\", temp);\r\n      } else {\r\n        const rel = this.relativeObj[this.currentItem.seatNum];\r\n        startSeatNum = rel.seatNum;\r\n        // 这里依赖对象的属性顺序\r\n        for (let num in this.relativeObj) {\r\n          let a = this.relativeObj[num];\r\n          if (num <= startSeatNum || a.currentState.couldSeat === 2) continue;\r\n          arr.push(a)\r\n          if (a.person) havePersonArr.push(a)\r\n        }\r\n        //先删除这些座位\r\n        const temp = this.relativeList.filter(a => {\r\n          if (a.id === rel.id) return false;   //删除当前选中的这个座位\r\n          let index = arr.findIndex(b => b.id === a.id)\r\n          return index === -1\r\n        })\r\n        this.$emit(\"update:relativeList\", temp);\r\n      }\r\n        \r\n      //再重新将人按顺序插入\r\n      this.$nextTick(() => {\r\n        let i = 0, k = 0\r\n        while (k < havePersonArr.length) {\r\n          const seat = this.seatObj[startSeatNum + i];\r\n          const person = havePersonArr[k].person;\r\n          if (this.relativeObj[startSeatNum + i]?.currentState?.couldSeat === 2) {\r\n            i++\r\n            continue\r\n          }\r\n          if (_.isFunction(this.layoutConfig.isSeatAble)) {\r\n            let isSeatAble = this.layoutConfig.isSeatAble(seat, person)\r\n            if (!isSeatAble) {\r\n              i++\r\n              continue;\r\n            }\r\n          }\r\n          this.relativeList.push(newRelative(seat, person))\r\n          i++;\r\n          k++;\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n  \r\nfunction _singleSetStatus(rel, targetItem, currentState) {\r\n  if (rel) {\r\n    rel.currentState = currentState\r\n    if (currentState.couldSeat === 2 && currentState.statusValue !== 3 && rel.person) rel.person = null;  //如果禁用则清除座位上的人员\r\n  } else {\r\n    const newRelative = {\r\n      id: targetItem.id,\r\n      pid: targetItem.parentId,\r\n      belong: targetItem.belong,\r\n      currentState: currentState,\r\n      person: null,\r\n      seatNum: targetItem.seatNum\r\n    }\r\n    this.relativeList.push(newRelative);\r\n  }\r\n}\r\n\r\n</script>","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatPop.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatPop.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./seatPop.vue?vue&type=template&id=43c0207b&\"\nimport script from \"./seatPop.vue?vue&type=script&lang=js&\"\nexport * from \"./seatPop.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('43c0207b')) {\n      api.createRecord('43c0207b', component.options)\n    } else {\n      api.reload('43c0207b', component.options)\n    }\n    module.hot.accept(\"./seatPop.vue?vue&type=template&id=43c0207b&\", function () {\n      api.rerender('43c0207b', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView/seatPop.vue\"\nexport default component.exports","<template>\r\n  <div class=\"ds-designer ds-seat-container ds-seat-view\">\r\n    <div class=\"designer-head\">\r\n      <top-tools\r\n        v-bind.sync=\"postData\"\r\n        :relative-list.sync=\"relativeList\"\r\n        :seat-obj=\"seatObj\"\r\n        :relative-obj=\"relativeObj\"\r\n        @save=\"save\"\r\n        @clear=\"clear\"\r\n      ></top-tools>\r\n    </div>\r\n    <div class=\"designer-content\">\r\n      <div class=\"seat-designer-center\">\r\n        <left-tree \r\n          :relative-list.sync=\"relativeList\"\r\n          :person-obj.sync=\"personObj\"\r\n          :seat-obj=\"seatObj\"\r\n          :relative-obj=\"relativeObj\"\r\n        ></left-tree>\r\n        <seat-canvas>\r\n          <template v-slot:seat>\r\n            <seat-item\r\n              v-bind.sync=\"postData\"\r\n              :relative-list.sync=\"relativeList\"\r\n              :chosen-items.sync=\"chosenItems\"\r\n              :key-stack=\"keyStack\"\r\n              :seat-obj=\"seatObj\"\r\n              :person-obj=\"personObj\"\r\n              :relative-obj=\"relativeObj\"\r\n            >\r\n            </seat-item>\r\n          </template>\r\n          <template v-slot:seatPop>\r\n            <seat-pop\r\n              :relative-list.sync=\"relativeList\"\r\n              :chosen-items.sync=\"chosenItems\"\r\n              :seat-obj=\"seatObj\"\r\n              :relative-obj=\"relativeObj\"\r\n            >\r\n            </seat-pop>\r\n          </template>\r\n        </seat-canvas>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport topTools from \"_platform/designer/seat/seatView/topTools\";\r\nimport leftTree from \"_platform/designer/seat/seatView/leftTree\";\r\nimport canvas from \"_platform/designer/seat/seatView/canvas.vue\";\r\nimport seatItem from \"_platform/designer/seat/seatView/seatItem\";\r\nimport seatPop from \"_platform/designer/seat/seatView/seatPop\"\r\n  \r\nimport {changePanelSizeForBgImage, sysBindShortKey} from \"_platform/designer/seat/func\";\r\nimport eventBus from \"_platform/designer/seat/util/eventBus.js\";\r\nimport {eventBusEvent} from \"_platform/designer/seat/constant\";\r\nimport ConfigBuilder from \"_platform/designer/seat/util/configBuilder.js\";\r\n  \r\nexport default {\r\n  name: \"DsfSeatView\",\r\n  provide(){\r\n    return{\r\n      layoutConfigPointer: ()=> this.layoutConfig,\r\n      leftTreeConfigPointer:() => this.leftTreeConfig\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      keyStack: [],\r\n        \r\n      //下面这些为提供给子组件的props\r\n      postData: {\r\n        _id: \"\",\r\n          \r\n        //用于top-tools组件的\r\n        backgroundImage: {},\r\n        canvasSet: {},\r\n        hasBg: false,\r\n          \r\n        //用于seat-item组件的\r\n        items: [],\r\n        groups: [],\r\n      },\r\n        \r\n      //用于left-tree组件的\r\n      leftList: [],\r\n      personObj: {},    //所有的用户k/v\r\n        \r\n        \r\n      //所有的入座情况\r\n      relativeList: [],\r\n        \r\n      //多个选中的座位\r\n      chosenItems: [],\r\n        \r\n      //包含所有座位的对象，以座位号为key(只是座位信息，无排座信息)\r\n      seatObj: null,\r\n        \r\n      //配置文件\r\n      layoutConfig: null,\r\n      leftTreeConfig: null\r\n    }\r\n  },\r\n  computed: {\r\n    relativeObj() {\r\n      const obj = {};\r\n      for (let i = 0; i < this.relativeList.length; i++) {\r\n        let rel = this.relativeList[i];\r\n        obj[rel.seatNum] = rel;\r\n      }\r\n      return obj\r\n    },\r\n  },\r\n  watch: {\r\n    \"postData.backgroundImage\"() {\r\n      changePanelSizeForBgImage.call(this);\r\n    }\r\n  },\r\n  components: {\r\n    topTools,\r\n    leftTree,\r\n    seatCanvas: canvas,\r\n    seatItem,\r\n    seatPop\r\n  },\r\n  created() {\r\n    const layoutUrl = dsf.url.getWebPath(\"$/seat_config/seat/viewSeatLayout.js\");\r\n    const leftTreeUrl = dsf.url.getWebPath(\"$/seat_config/seat/viewLeftTree.js\")\r\n  \r\n    this.$http.importFiles([layoutUrl, leftTreeUrl]).then((res) => {\r\n      this.layoutConfig = new ConfigBuilder(viewSeatLayoutConfig, this.$route.query.opt);\r\n      this.leftTreeConfig = new ConfigBuilder(viewLeftTreeConfig, this.$route.query.opt);\r\n      eventBus.dispatch(eventBusEvent.CONFIG_FILE_LOADED);\r\n        \r\n      this.getSeatInfo();\r\n      this.bindShortKey();\r\n    });\r\n  },\r\n  methods: {\r\n    getSeatInfo() {\r\n      const id = this.$route.query.id;\r\n      if (!id) return;\r\n      const data = JSON.parse(localStorage.getItem(\"seat_\" + id));\r\n      if (!data) return;\r\n      if (_.isEmpty(data.canvasSet)) {\r\n        data.canvasSet = {\r\n          width: undefined,\r\n          height: undefined\r\n        }\r\n      }\r\n      this.postData = data;\r\n        \r\n      //生成seatObj 对象\r\n      const seatObj = {};\r\n      data.items.forEach(a => {\r\n        seatObj[a.seatNum] = a\r\n      })\r\n      data.groups.forEach(a => {\r\n        a.member.forEach(b => {\r\n          seatObj[b.seatNum] = b\r\n        })\r\n      })\r\n      this.seatObj = seatObj\r\n        \r\n      const relId = this.$route.query.relId;\r\n      if (!relId) return;\r\n      const relativeList = JSON.parse(localStorage.getItem(\"relation_\" + relId));\r\n      if (!relativeList) return;\r\n      this.relativeList = relativeList;\r\n    },\r\n    bindShortKey() {\r\n      const stopList = [\"ctrl\", \"ctrl-d\", \"ctrl-s\"];\r\n      sysBindShortKey(this.keyStack, stopList);\r\n        \r\n      $(\".seat-designer-page\").on(\"click\", function () {\r\n        eventBus.dispatch(eventBusEvent.BODY_EMPTY_CLICK);\r\n      })\r\n    },\r\n    save() {\r\n      const relId = this.$route.query.relId || dsf.uuid();\r\n      localStorage.setItem(\"relation_\" + relId, JSON.stringify(this.relativeList));\r\n      const originQuery = this.$route.query;\r\n      const _query = Object.assign({}, originQuery, {relId: relId})\r\n      this.$router.replace({path: this.$route.path, query: _query})\r\n    },\r\n    clear() {\r\n      this.relativeList = [];\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style type=\"text/scss\" lang=\"scss\">\r\n  @import \"~_platform/assets/styles/designer/seatDesign.scss\";\r\n</style>","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seatView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./seatView.vue?vue&type=template&id=9ab30404&\"\nimport script from \"./seatView.vue?vue&type=script&lang=js&\"\nexport * from \"./seatView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./seatView.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"I:\\\\web-project\\\\dream\\\\dsf-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('9ab30404')) {\n      api.createRecord('9ab30404', component.options)\n    } else {\n      api.reload('9ab30404', component.options)\n    }\n    module.hot.accept(\"./seatView.vue?vue&type=template&id=9ab30404&\", function () {\n      api.rerender('9ab30404', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"designer/seat/seatView.vue\"\nexport default component.exports"],"sourceRoot":""}