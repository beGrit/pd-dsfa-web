/*! Build time : Mon Jul 19 2021 18:19:59 GMT+0800 (GMT+08:00) */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dsf-pc"],{"0430":function(e,n,t){},"0b36":function(e,n,t){},"1b73":function(e,n,t){"use strict";t("0b36")},"7c3f":function(e,n,t){"use strict";t("4160"),t("b0c0");var o=[];function i(e){o.forEach((function(n){e.component(n.name,n),window.$components["nc"]||(window.$components["nc"]={}),window.$components["nc"][n.name]=n}))}"undefined"!==typeof window&&window.Vue&&i(window.Vue),n["a"]=i},a849:function(e,n,t){"use strict";t("e53b")},d3da:function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d"),t("ac1f"),t("5319"),t("fb6a"),t("a745"),t("0430"),t("4ce4"),t("365c");var o=t("7c3f"),i=t("5d45"),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("home",{attrs:{"page-suffix":e.pageSuffix}})],1)},s=[],c=(t("c975"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"full-view"},["index"==e.pageSuffix?t("dsf-home",{attrs:{"menu-list":e.menuList}},[t("dsf-default-home-header",{attrs:{slot:"header","dropdown-config":e.dropdownConfig},on:{"dropdown-click":e.dropdownClick},slot:"header"}),t("dsf-default-home-aside-menu",{attrs:{slot:"left",position:"left"},slot:"left"}),t("router-view",{staticStyle:{"min-height":"100%"},attrs:{fit:""}}),t("dsf-personalization",{attrs:{show:e.personalizationShow},on:{"update:show":function(n){e.personalizationShow=n}}})],1):"index1"==e.pageSuffix?t("dsf-home",{attrs:{"menu-list":e.menuList}},[t("dsf-template1-home-header",{attrs:{slot:"header","dropdown-config":e.dropdownConfig,"last-level-click":""},on:{"dropdown-click":e.dropdownClick},slot:"header"}),t("dsf-default-home-breadcrumb",{attrs:{slot:"breadcrumb"},slot:"breadcrumb"}),t("dsf-default-home-footer",{attrs:{slot:"footer",text:"技术支持：上海梦创双杨数据科技股份有限公司"},slot:"footer"}),t("router-view",{attrs:{fit:""}}),t("dsf-personalization",{attrs:{show:e.personalizationShow},on:{"update:show":function(n){e.personalizationShow=n}}})],1):"ncIndex"==e.pageSuffix?t("dsf-home",{attrs:{"menu-list":e.menuList}},[t("dsf-college-home",{attrs:{"dropdown-config":e.dropdownConfig,"logo-url":e.dsf.config.setting_public_logo_url,"custom-bts":[{name:"登录",handler:e.loginHandler}],"click-before":e.$checkLogin},on:{"dropdown-click":e.dropdownClick,search:e.searchSubmit},scopedSlots:e._u([{key:"footer",fn:function(){return[t("dsf-view-part",{attrs:{path:"/pc/nc/pagefooter/ncFooter"}})]},proxy:!0}])}),t("dsf-personalization",{attrs:{show:e.personalizationShow},on:{"update:show":function(n){e.personalizationShow=n}}})],1):t("router-view",{staticClass:"page-head-font-fixed"})],1)}),a=[],d={name:"Home",props:{pageSuffix:{type:String,default:"else"}},data:function(){return{personalizationShow:!1,dropdownConfig:[{name:"个性化设置",key:"personalization",handler:"personalizationSetting"},{name:"个人中心",key:"userCenter",handler:"userCenterSetting"},{name:"退出",key:"loginOut",handler:"loginOut"}],menuList:[]}},created:function(){"else"!=this.pageSuffix&&l.call(this)},methods:{dropdownClick:function(e){e.url?window.location.href=e.url:e.openUrl?window.open(e.openUrl):e.handler&&this[e.handler]&&this[e.handler](e)},personalizationSetting:function(){this.personalizationShow=!0},loginOut:function(){var e=this;dsf.layer.confirm("您确定要退出吗?").then((function(){e.$webAPI.loginOut().then((function(n){var t=n.success,o=n.message;t?(dsf.storage.session.clear(),"ncIndex"===e.pageSuffix?(location.href="#/pc/nc/pagehome/index",location.reload(!0)):location.replace(dsf.config.setting_public_pc_login_page)):dsf.layer.message(o,!1)})).catch((function(e){console.error(e),dsf.layer.message("退出失败",!1)}))})).catch((function(){}))},searchSubmit:function(e){this.$checkLogin().then((function(){var n=dsf.config.setting_public_search_url+"?kw="+e;n&&dsf.layer.openWindow(n)}))},userCenterSetting:function(){var e=dsf.config.setting_public_usercenter_url;dsf.layer.openWindow(e)},loginHandler:function(){this.$checkLogin()}}};function l(){var e=this,n=this.pageSuffix,t="ncIndex"===n?dsf.config.setting_public_index_menu_src:dsf.config.setting_public_home_menu_src;this.$http.get(t).done((function(n){var t=n.success,o=n.data;t&&(e.menuList=o,0==o.length&&dsf.httpError("当前菜单地址长度为0"))})).error((function(e){dsf.httpError(e)}))}var f=d,u=t("2877"),p=Object(u["a"])(f,c,a,!1,null,null,null),h=p.exports,g={components:{home:h},provide:function(){return{$app:this}},data:function(){return{pageSuffix:"else"}},created:function(){this.init();for(var e=window.location.pathname,n=["_project","_product",""],t="else",o=0;o<n.length;o++){if(e.indexOf("/index".concat(n[o],".html"))>=0){t="index";break}if(e.indexOf("/index1".concat(n[o],".html"))>=0){t="index1";break}if(e.indexOf("/ncIndex".concat(n[o],".html"))>=0){t="ncIndex";break}t="else"}this.pageSuffix=t},mounted:function(){},methods:{init:function(){var e=navigator.userAgent;if(e.toLowerCase().indexOf("dingtalk")>-1){var n=document.createElement("script");n.src="https://g.alicdn.com/dingding/dingtalk-jsapi/2.10.3/dingtalk.open.js",document.body.appendChild(n),n.onload=function(){},n.onerror=function(){},dsf.cookies.set("isDd",1)}dsf.cookies.set("checkDd",navigator.userAgent)}}},m=g,w=Object(u["a"])(m,r,s,!1,null,null,null),b=w.exports,v=t("4360"),x=t("2909"),_=(t("99af"),t("8c4f")),k=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("DsfPlatformLogin")],1)},S=[],y={name:"Login",data:function(){return{}},methods:{}},C=y,O=Object(u["a"])(C,k,S,!1,null,null,null),$=O.exports,I=function(){var e=this,n=e.$createElement,t=e._self._c||n;return e.show?t("div",{staticClass:"ds-error-wrap"},[t("div",{staticClass:"redict-content"},[t("img",{staticClass:"error-img",attrs:{src:e.errorImg}}),t("p",{staticClass:"sub-title"},[e._v("您访问的页面不存在...")]),t("div",{staticClass:"sub-button"},[t("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:function(n){return e.handleEvent("reload")}}},[e._v("刷新页面")]),t("el-button",{attrs:{type:"text",icon:"el-icon-refresh-left"},on:{click:function(n){return e.handleEvent("home")}}},[e._v("返回首页")])],1)])]):e._e()},L=[],E={name:"Error",data:function(){return{show:!0,errorImg:dsf.url.getWebPath("$/img/".concat(dsf.config.runType,"/404.png"))}},beforeMount:function(){},created:function(){this.show=!("/"==this.$route.path)},methods:{handleEvent:function(e){var n={reload:function(){location.reload()},home:function(){location.href="./index.html"}};n[e]&&n[e]()}},beforeRouteUpdate:function(e,n,t){this.show=!("/"==e.path),t()}},P=E,z=(t("1b73"),Object(u["a"])(P,I,L,!1,null,"32cdce70",null)),V=z.exports,j=function(){var e=this,n=e.$createElement;e._self._c;return e._m(0)},A=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"dd-login-view"},[t("div",{staticClass:"remind"},[e._v("正在校验用户信息...")])])}],D=(t("d3b7"),t("466d"),{name:"ddLogin",data:function(){return{corpId:this.$route.query.corpId}},created:function(){this.initDd()},methods:{initDd:function(){var e=this,n=new Promise((function(e,n){var t=document.createElement("script");t.src="https://g.alicdn.com/dingding/dingtalk-jsapi/2.10.3/dingtalk.open.js",document.body.appendChild(t),t.onload=function(){e()},t.onerror=function(){n()}}));return n.then((function(){var n=e.corpId;return n?e.authentication(n):dsf.layer.message("当前企业corpId为空",!1)}))},initDdConfig:function(){var e=this,n=this.corpId;return new Promise((function(t,o){var i="/api/ding/publics/config";e.$http.get(i,{corpId:n}).done((function(e){e.success?t(e):o(e)})).error((function(e){o(e)}))}))},ddLogin:function(e){var n="login/ding",t={code:e,corpId:this.corpId};this.$http.post(n,t).done((function(e){if(e.success){var n=dsf.client.android()||dsf.client.iOS()?dsf.config.setting_public_mobileindex_url:dsf.config.setting_public_pcindex_url;dsf.cookies.set("isLogin",1),location.href=n}else dsf.layer.message("自动登录:"+e.message,!1)})).error((function(e){dsf.layer.message("自动登录:"+err.message,!1)}))},authentication:function(){var e=this,n=this.corpId;"notInDingTalk"!==dd.env.platform?this.initDdConfig().then((function(t){dd.runtime.permission.requestAuthCode({corpId:n,onSuccess:function(n){e.ddLogin(n.code)},onFail:function(e){dsf.layer.message("获取authCode失败")}})})).catch((function(e){dsf.layer.message("API：/api/ding/publics/config"+e.message,!1)})):console.log("notInDingTalk")},checkPlatfrom:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,qq:" qq"==e.match(/\sQQ/i)}}}}),q=D,T=(t("a849"),Object(u["a"])(q,j,A,!1,null,null,null)),M=T.exports;Vue.use(_["a"]);var U=[].concat(Object(x["a"])($platformRouter.pc),[{path:"/pc/login",meta:{title:"登录",needLogin:!1},component:$},{path:"/pc/ddLogin",meta:{title:"钉钉",needLogin:!1},component:M},{path:"*",component:V}]),W=new _["a"]({mode:"hash",base:"",routes:U});W.beforeEach((function(e,n,t){document.querySelector(".dsf-college-home")&&document.querySelector(".dsf-college-home").scrollTo({top:0}),t()})),dsf.init.initRouter(W,"pc");var H=W,K=t("12cb"),R=t("9401");Vue.use(o["a"]);var F=new Vue;Object.defineProperties(Vue.prototype,{$bus:{get:function(){return F}}}),dsf.init.initPlatform(Vue),dsf.init.globalMixin(Vue),Vue.config.productionTip=!1,Vue.config.devtools=!0,Vue.prototype.$checkLogin=i["a"];var G=dsf.config.setting_public_pc_login_page;H.beforeEach((function(e,n,t){if(!e.meta.needLogin&&"/"!=e.fullPath||dsf.getToken())document.title=e.meta.title||dsf.config.setting_public_logo_title||"",t();else{var o=G+("/"!==e.fullPath?"?from="+encodeURIComponent(location.href):"");location.replace(o)}})),new Vue({mixins:[dsf.$systemGlobalSetting(R["a"])],store:v["a"],router:H,i18n:K["a"],created:function(){dsf.resizeDetector(),"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&window.addEventListener("hashchange",(function(){var e=window.location.hash.slice(1);console.log(H.replace),H.path!==e&&H.replace(e)}),!1)},render:function(e){return e(b)}}).$mount("#app")},e53b:function(e,n,t){}}]);
//# sourceMappingURL=dsf-pc.js.map